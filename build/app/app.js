var app=angular.module("colorIpsum",["ngAnimate"]);app.controller("mainController",["$scope","coloripsum","$timeout",function(t,n,e){function r(){var t=n.random();return o(t,"Colors for devs"),t}function o(t,n){var e=window.location.pathname.split("/"),r="/"+e[e.length-1],o="/"+t.noHash.main+"-"+t.noHash.complementary+"-"+t.noHash.dark+"-"+t.noHash.light;o===r?history.replaceState({scheme:t},n):history.pushState({scheme:t},n,o)}t.versionColor="#E52B50",t.version="1.7",t.scheme={main:"#000000",complementary:"#000000",dark:"#000000",light:"#000000",noHash:{main:"000000",complementary:"000000",dark:"000000",light:"000000"},luminocity:{main:1,complementary:1,dark:1,light:1},uiColors:{background:"#000000",hex:"#000000",texts:"#000000"}},t.rotate=!1;var a=function(){var t=null,n=window.location.pathname.split("/"),e=n[n.length-1];if(null!==e.match(/^(([a-fA-F0-9]){6})-(([a-fA-F0-9]){6})-(([a-fA-F0-9]){6})-(([a-fA-F0-9]){6})$/gi)){var r=e.split("-");t={main:"#"+r[0],complementary:"#"+r[1],dark:"#"+r[2],light:"#"+r[3],noHash:{main:r[0],complementary:r[1],dark:r[2],light:r[3]}}}return t}();t.scheme=null!==a?function(t){var e=n.generatePaletteFromURL(t);return o(e,"Colors for devs"),e}(a):r(),t.onKeyUp=function(n){32==n.keyCode&&(t.scheme=r())},t.generateRandom=function(n){t.rotate=!0,e(function(){t.rotate=!1},700),t.scheme=r()},t.generatePalette=function(t){return function(t){var e=n.palette(t);return o(e,"Colors for devs"),e}(t)},t.buildInfo=function(){var e={mainHex:t.versionColor};t.versionScheme=function(t){return n.palette(t)}(e),$("body").css("overflow","hidden"),$(".about").fadeIn(200),$(".about-container").show("drop",{direction:"down"},200,function(){$("body").css("overflow","auto")})},t.closeAbout=function(t){"panel about"===t.target.className&&($(".about").css("cursor","auto"),$("body").css("overflow","hidden"),$(".about").fadeOut(200),$(".about-container").hide("drop",{direction:"down"},200,function(){$("body").css("overflow","auto")}))},t.changeCursor=function(t){"panel about"===t.target.className?$(".about").css("cursor","url(assets/images/close.gif), crosshair"):$(".about").css("cursor","auto")},t.selectHexString=function(t){var n,e,r=t.currentTarget.className,o=document.getElementsByClassName(r)[0];window.getSelection?(e=window.getSelection(),(n=document.createRange()).selectNodeContents(o),e.removeAllRanges(),e.addRange(n)):document.body.createTextRange&&((n=document.body.createTextRange()).moveToElementText(o),n.select())};var i=new Clipboard(".color");i.on("success",function(t){var n=$(t.trigger).attr("class").replace(" color","");$("."+n+".hex .hint")[0]||$("."+n+".hex").append('<span class="hint">copied to clipboard</span>').show(function(){$(".hint").fadeOut(1e3,function(){$(this).remove()})})}),i.on("error",function(t){var n=$(t.trigger).attr("class").replace(" color","");$("."+n+".hex .hint")[0]||$("."+n+".hex").append('<span class="hint">ctrl+c to copy</span>').show(function(){$(".hint").fadeOut(1e3,function(){$(this).remove()})})}),window.onpopstate=function(n){null!==n.state&&t.$apply(function(){t.scheme=n.state.scheme})}}]),app.directive("spectrum",function(){return{restrict:"A",link:function(t,n,e){$(n).spectrum(t.$eval(e.spectrum)),$(n).on("reflow.spectrum",function(t){!function(t,n){var e=t.outerWidth(),r=t.outerHeight(),o=n.outerHeight(),a=t[0].ownerDocument,i=a.documentElement.clientWidth+$(a).scrollLeft(),c=n.offset();c.left+=84,c.top+=o,c.left=c.left+e>i&&i>e?Math.abs(c.left-e):c.left,c.top=Math.abs(c.top-42-r/2),t.css({left:c.left,top:c.top})}($(".sp-container"),$(".sp-replacer"))}),$(n).on("change.spectrum",function(n,e){var r={mainHex:e.toHexString()};t.$apply(function(){t.scheme=t.generatePalette(r)})}),t.$watch("scheme",function(t){$(n).spectrum("set",t.main),$(".sp-preview").css({color:t.uiColors.texts}),$(".sp-preview").css({background:t.main})})}}}),app.directive("setFocus",function(){return{restrict:"A",link:function(t,n,e){n[0].focus()}}}),app.service("coloripsum",function(){function t(t){for(var n=(0+(16777215-(t=function(t){return parseInt(t.replace(/^#/,""),16)}(t))).toString(16)).slice(-6);n.length<6;)n="0"+n;return"#"+n}function n(t,n){return e(t)<=.5?function(t,n){var e={};return e.r=Math.round(2*t.r*n.r/255),e.g=Math.round(2*t.g*n.g/255),e.b=Math.round(2*t.b*n.b/255),e.a=n.a,r(e,t)}(t,n):function(t,n){var e={};return e.r=Math.round(255*(1-(1-t.r/255)*(1-(2*n.r/255-1)))),e.g=Math.round(255*(1-(1-t.g/255)*(1-(2*n.g/255-1)))),e.b=Math.round(255*(1-(1-t.b/255)*(1-(2*n.b/255-1)))),e.a=n.a,r(e,t)}(t,n)}function e(t){return(t.r+t.g+t.b)/3/255}function r(t,n){var e={};return e.r=(1-t.a)*n.r+t.a*t.r,e.g=(1-t.a)*n.g+t.a*t.g,e.b=(1-t.a)*n.b+t.a*t.b,function(t,n,e){return"#"+i(t)+i(n)+i(e)}(e.r,e.g,e.b)}function o(t,n){return{r:function(t){return parseInt(a(t).substring(0,2),16)}(t),g:function(t){return parseInt(a(t).substring(2,4),16)}(t),b:function(t){return parseInt(a(t).substring(4,6),16)}(t),a:n}}function a(t){return"#"==t.charAt(0)?t.substring(1,7):t}function i(t){return t=parseInt(t,10),isNaN(t)?"00":(t=Math.max(0,Math.min(t,255)),"0123456789ABCDEF".charAt((t-t%16)/16)+"0123456789ABCDEF".charAt(t%16))}function c(t){var n=Math.random(),e="#EEEEEE";t&&(e="#777777",n=-n);var r=parseInt(e.slice(1),16),o=n<0?0:255,a=n<0?-1*n:n,i=r>>16,c=r>>8&255,u=255&r;return"#"+(16777216+65536*(Math.round((o-i)*a)+i)+256*(Math.round((o-c)*a)+c)+(Math.round((o-u)*a)+u)).toString(16).slice(1)}function u(t,n,e){return r(o(t,n),o(e,1))}function s(t,e,r){var a=o(t,e);return n(o(r,1),a)}function l(t){return e(o(t,1))}function m(t){var n={};return n.background=u(t,.1,"#FFFFFF"),n.hex=u(t,.6,n.background),l(n.background)>.85&&l(n.hex)>.85&&(n.hex=u(n.hex,.9,"#424242")),n.texts=s(t,.2,"#424242"),n}function h(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}var p=this,f=function(){return{main:"",complementary:"",dark:"",light:"",noHash:{main:"",complementary:"",dark:"",light:""},luminocity:{main:"",complementary:"",dark:"",light:""},uiColors:{background:"",hex:"",texts:""}}};this.random=function(){var t=function(){for(var t="";t.length<6;)t+=Math.random().toString(16).substr(-6).substr(-1);return"#"+t}(),n=c(!0),e=c(!1);return p.palette({mainHex:t,darkHex:n,lightHex:e})},this.palette=function(n){var e=h({mainHex:"#FFFFFF",darkHex:"#424242",lightHex:"#FAFAFA"},n),r=new f;return r.main=e.mainHex,r.noHash.main=a(r.main).toUpperCase(),r.luminocity.main=l(r.main),r.complementary=t(e.mainHex),r.noHash.complementary=a(r.complementary).toUpperCase(),r.luminocity.complementary=l(r.complementary),r.dark=s(e.mainHex,.2,e.darkHex),r.noHash.dark=a(r.dark).toUpperCase(),r.luminocity.dark=l(r.dark),r.light=s(e.mainHex,.2,e.lightHex),r.noHash.light=a(r.light).toUpperCase(),r.luminocity.light=l(r.light),r.uiColors=h(r.uiColors,m(r.main)),r},this.generatePaletteFromURL=function(t){var n=h(new f,t);return n.luminocity.main=l(n.main),n.luminocity.complementary=l(n.complementary),n.luminocity.dark=l(n.dark),n.luminocity.light=l(n.light),n.uiColors=h(n.uiColors,m(n.main)),n},this.hexToRGBA=function(t,n){return o(t,n)},this.rgbaToHex=function(t,n){return r(t,n)},this.hexOpacity=function(t,n,e){return u(t,n,e)},this.hexBlendOverlay=function(t,n,e){return s(t,n,e)},this.hexLuminocity=function(t){return l(t)}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbG9yaXBzdW0uanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJjb2xvcmlwc3VtIiwiJHRpbWVvdXQiLCJyYW5kb21TY2hlbWUiLCJzY2hlbWUiLCJyYW5kb20iLCJoaXN0b3J5UmVmcmVzaCIsInRpdGxlIiwicGF0aEFycmF5Iiwid2luZG93IiwibG9jYXRpb24iLCJwYXRobmFtZSIsInNwbGl0IiwiY3VycmVudFVSTCIsImxlbmd0aCIsIm5ld1VSTCIsIm5vSGFzaCIsIm1haW4iLCJjb21wbGVtZW50YXJ5IiwiZGFyayIsImxpZ2h0IiwiaGlzdG9yeSIsInJlcGxhY2VTdGF0ZSIsInB1c2hTdGF0ZSIsInZlcnNpb25Db2xvciIsInZlcnNpb24iLCJsdW1pbm9jaXR5IiwidWlDb2xvcnMiLCJiYWNrZ3JvdW5kIiwiaGV4IiwidGV4dHMiLCJyb3RhdGUiLCJoZXhTdHJpbmciLCJtYXRjaCIsImNvbG9yc0FycmF5IiwiY2hlY2tGb3JVcmxWYWx1ZXMiLCJvcHRpb25zIiwiZ2VuZXJhdGVQYWxldHRlRnJvbVVSTCIsIm9uS2V5VXAiLCIkZXZlbnQiLCJrZXlDb2RlIiwiZ2VuZXJhdGVSYW5kb20iLCJnZW5lcmF0ZVBhbGV0dGUiLCJwYWxldHRlIiwiYnVpbGRJbmZvIiwibWFpbkhleCIsInZlcnNpb25TY2hlbWUiLCJ2ZXJzaW9uUGFsZXR0ZSIsIiQiLCJjc3MiLCJmYWRlSW4iLCJzaG93IiwiZGlyZWN0aW9uIiwiY2xvc2VBYm91dCIsInRhcmdldCIsImNsYXNzTmFtZSIsImZhZGVPdXQiLCJoaWRlIiwiY2hhbmdlQ3Vyc29yIiwic2VsZWN0SGV4U3RyaW5nIiwicmFuZ2UiLCJzZWxlY3Rpb24iLCJlbGVtZW50Q2xhc3MiLCJjdXJyZW50VGFyZ2V0IiwiZWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImdldFNlbGVjdGlvbiIsImNyZWF0ZVJhbmdlIiwic2VsZWN0Tm9kZUNvbnRlbnRzIiwicmVtb3ZlQWxsUmFuZ2VzIiwiYWRkUmFuZ2UiLCJib2R5IiwiY3JlYXRlVGV4dFJhbmdlIiwibW92ZVRvRWxlbWVudFRleHQiLCJzZWxlY3QiLCJjbGlwYm9hcmQiLCJDbGlwYm9hcmQiLCJvbiIsImUiLCJjb2xvciIsInRyaWdnZXIiLCJhdHRyIiwicmVwbGFjZSIsImFwcGVuZCIsInRoaXMiLCJyZW1vdmUiLCJvbnBvcHN0YXRlIiwiZXZlbnQiLCJzdGF0ZSIsIiRhcHBseSIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwibGluayIsInNjb3BlIiwiYXR0cnMiLCJzcGVjdHJ1bSIsIiRldmFsIiwicGlja2VyIiwiaW5wdXQiLCJkcFdpZHRoIiwib3V0ZXJXaWR0aCIsImRwSGVpZ2h0Iiwib3V0ZXJIZWlnaHQiLCJpbnB1dEhlaWdodCIsImRvYyIsIm93bmVyRG9jdW1lbnQiLCJ2aWV3V2lkdGgiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsInNjcm9sbExlZnQiLCJvZmZzZXQiLCJsZWZ0IiwidG9wIiwiTWF0aCIsImFicyIsInNldFBpY2tlclBvc2l0aW9uIiwidGlueWNvbG9yIiwidG9IZXhTdHJpbmciLCIkd2F0Y2giLCJmb2N1cyIsInNlcnZpY2UiLCJmaW5kQ29tcGxlbWVudGFyeSIsInBhcnNlSW50IiwiaGV4U3RyaW5nVG9oZXgiLCJ0b1N0cmluZyIsInNsaWNlIiwiYmxlbmRPdmVybGF5IiwiYmFzZVJHQiIsImNvbG9yUkdCQSIsInJnYkx1bWlub2NpdHkiLCJibGVuZCIsInIiLCJyb3VuZCIsImciLCJiIiwiYSIsInJnYmFUb0hleCIsImJsZW5kTXVsdGlwbHkiLCJibGVuZFNjcmVlbiIsInJnYiIsInJnYmEiLCJSIiwiRyIsIkIiLCJ0b0hleCIsInJnYlRvSGV4IiwiaGV4VG9SR0JBIiwiYWxwaGEiLCJjdXRIZXgiLCJzdWJzdHJpbmciLCJoZXhUb1IiLCJoZXhUb0ciLCJoZXhUb0IiLCJjaGFyQXQiLCJuIiwiaXNOYU4iLCJtYXgiLCJtaW4iLCJyYW5kb21TaGFkZXMiLCJwZXJjZW50IiwiZiIsInQiLCJwIiwiaGV4T3BhY2l0eSIsImJhc2VIZXgiLCJoZXhCbGVuZE92ZXJsYXkiLCJoZXhMdW1pbm9jaXR5IiwiZ2VuZXJhdGVVSUNvbG9ycyIsIlVJQ29sb3JzIiwiZXh0ZW5kIiwia2V5IiwiaGFzT3duUHJvcGVydHkiLCJzZWxmIiwicGFsZXR0ZVRlbXBsYXRlIiwic3Vic3RyIiwicmFuZG9tSGV4IiwiZGFya0hleCIsImxpZ2h0SGV4Iiwib3B0cyIsInRvVXBwZXJDYXNlIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFBQSxJQUFBQyxRQUFBQyxPQUFBLGNBQUEsY0FFQUYsSUFBQUcsV0FBQSxrQkFBQSxTQUFBLGFBQUEsV0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQW9OQSxTQUFBQyxJQUNBLElBQUFDLEVBQUFILEVBQUFJLFNBSUEsT0FGQUMsRUFBQUYsRUFBQSxtQkFFQUEsRUFxQ0EsU0FBQUUsRUFBQUYsRUFBQUcsR0FDQSxJQUNBQyxFQURBQyxPQUFBQyxTQUFBQyxTQUNBQyxNQUFBLEtBQ0FDLEVBQUEsSUFBQUwsRUFBQUEsRUFBQU0sT0FBQSxHQUNBQyxFQUFBLElBQUFYLEVBQUFZLE9BQUFDLEtBQUEsSUFBQWIsRUFBQVksT0FBQUUsY0FBQSxJQUFBZCxFQUFBWSxPQUFBRyxLQUFBLElBQUFmLEVBQUFZLE9BQUFJLE1BRUFMLElBQUFGLEVBQ0FRLFFBQUFDLGNBQUFsQixPQUFBQSxHQUFBRyxHQUVBYyxRQUFBRSxXQUFBbkIsT0FBQUEsR0FBQUcsRUFBQVEsR0FyUUFmLEVBQUF3QixhQUFBLFVBQ0F4QixFQUFBeUIsUUFBQSxNQUVBekIsRUFBQUksUUFDQWEsS0FBQSxVQUNBQyxjQUFBLFVBQ0FDLEtBQUEsVUFDQUMsTUFBQSxVQUNBSixRQUNBQyxLQUFBLFNBQ0FDLGNBQUEsU0FDQUMsS0FBQSxTQUNBQyxNQUFBLFVBRUFNLFlBQ0FULEtBQUEsRUFDQUMsY0FBQSxFQUNBQyxLQUFBLEVBQ0FDLE1BQUEsR0FFQU8sVUFD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QTFJLEdBU0EsT0FQQU8sRUFBQWpCLFdBQUFULEtBQUFzSixFQUFBNUgsRUFBQTFCLE1BQ0EwQixFQUFBakIsV0FBQVIsY0FBQXFKLEVBQUE1SCxFQUFBekIsZUFDQXlCLEVBQUFqQixXQUFBUCxLQUFBb0osRUFBQTVILEVBQUF4QixNQUNBd0IsRUFBQWpCLFdBQUFOLE1BQUFtSixFQUFBNUgsRUFBQXZCLE9BRUF1QixFQUFBaEIsU0FBQStJLEVBQUEvSCxFQUFBaEIsU0FBQTZJLEVBQUE3SCxFQUFBMUIsT0FFQTBCLEdBR0EwQyxLQUFBOEQsVUFBQSxTQUFBdEgsRUFBQXVILEdBQ0EsT0FBQUQsRUFBQXRILEVBQUF1SCxJQUdBL0QsS0FBQW9ELFVBQUEsU0FBQUksRUFBQWIsR0FDQSxPQUFBUyxFQUFBSSxFQUFBYixJQUdBM0MsS0FBQStFLFdBQUEsU0FBQXZJLEVBQUF1SCxFQUFBaUIsR0FDQSxPQUFBRCxFQUFBdkksRUFBQXVILEVBQUFpQixJQUdBaEYsS0FBQWlGLGdCQUFBLFNBQUF6SSxFQUFBdUgsRUFBQWlCLEdBQ0EsT0FBQUMsRUFBQXpJLEVBQUF1SCxFQUFBaUIsSUFHQWhGLEtBQUFrRixjQUFBLFNBQUExSSxHQUNBLE9BQUEwSSxFQUFBMUkiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdjb2xvcklwc3VtJyxbJ25nQW5pbWF0ZSddKTtcblxuYXBwLmNvbnRyb2xsZXIoJ21haW5Db250cm9sbGVyJywgWyckc2NvcGUnLCAnY29sb3JpcHN1bScsICckdGltZW91dCcsIGZ1bmN0aW9uKCRzY29wZSwgY29sb3JpcHN1bSwgJHRpbWVvdXQpIHtcblx0XG5cdCRzY29wZS52ZXJzaW9uQ29sb3IgPSAnI0U1MkI1MCc7XG5cdCRzY29wZS52ZXJzaW9uICAgICAgPSAnMS43Jztcblx0XG5cdCRzY29wZS5zY2hlbWUgPSB7XG5cdFx0bWFpbiA6ICcjMDAwMDAwJyxcblx0XHRjb21wbGVtZW50YXJ5IDogJyMwMDAwMDAnLFxuXHRcdGRhcmsgOiAnIzAwMDAwMCcsXG5cdFx0bGlnaHQgOiAnIzAwMDAwMCcsXG5cdFx0bm9IYXNoIDoge1xuXHRcdFx0bWFpbiA6ICcwMDAwMDAnLFxuXHRcdFx0Y29tcGxlbWVudGFyeSA6ICcwMDAwMDAnLFxuXHRcdFx0ZGFyayA6ICcwMDAwMDAnLFxuXHRcdFx0bGlnaHQgOiAnMDAwMDAwJ1xuXHRcdH0sXG5cdFx0bHVtaW5vY2l0eSA6IHtcblx0XHRcdG1haW4gOiAxLFxuXHRcdFx0Y29tcGxlbWVudGFyeSA6IDEsXG5cdFx0XHRkYXJrIDogMSxcblx0XHRcdGxpZ2h0IDogMVxuXHRcdH0sXG5cdFx0dWlDb2xvcnMgOiB7XG5cdFx0XHRiYWNrZ3JvdW5kIDogJyMwMDAwMDAnLFxuXHRcdFx0aGV4IDogJyMwMDAwMDAnLFxuXHRcdFx0dGV4dHMgOiAnIzAwMDAwMCdcblx0XHR9XG5cdH07XG5cdFxuXHQkc2NvcGUucm90YXRlID0gZmFsc2U7XG5cdFxuXHR2YXIgc2NoZW1lID0gY2hlY2tGb3JVcmxWYWx1ZXMoKTtcblx0XG5cdC8vIENoZWNrIGlmIGNvbG9yIHBhbGV0dGUgaXMgZ2l2ZW4gdGhyb3VnaCBVUkwgdmFsdWVzXG5cdGlmIChzY2hlbWUgIT09IG51bGwpIHtcblx0XHQkc2NvcGUuc2NoZW1lID0gZ2VuZXJhdGVQYWxldHRlRnJvbVVSTChzY2hlbWUpO1xuXHR9IGVsc2Uge1xuXHRcdCRzY29wZS5zY2hlbWUgPSByYW5kb21TY2hlbWUoKTtcblx0fVx0XG5cdFxuXHQkc2NvcGUub25LZXlVcCA9IGZ1bmN0aW9uKCRldmVudCkge1xuXHRcdGlmICgkZXZlbnQua2V5Q29kZSA9PSAzMikge1xuXHRcdFx0JHNjb3BlLnNjaGVtZSA9IHJhbmRvbVNjaGVtZSgpO1xuXHRcdH1cblx0fTtcblx0XG5cdCRzY29wZS5nZW5lcmF0ZVJhbmRvbSA9IGZ1bmN0aW9uKCRldmVudCApIHtcblx0XHQkc2NvcGUucm90YXRlID0gdHJ1ZTtcblx0XHRcblx0XHQkdGltZW91dChmdW5jdGlvbigpeyBcblx0XHRcdCRzY29wZS5yb3RhdGUgPSBmYWxzZTtcblx0XHR9LCA3MDApO1xuXHRcdFxuXHRcdFxuXHRcdCRzY29wZS5zY2hlbWUgPSByYW5kb21TY2hlbWUoKTtcblx0fTtcblx0XG5cdC8vTmVlZCBwYWxldHRlIGZ1bmN0aW9uIHRvIGJlIGFjY2Vzc2libGUgZnJvbSBzY29wZSB0byB1c2UgaXQgaW4gc3BlY3RydW0gZGlyZWN0aXZlXG5cdCRzY29wZS5nZW5lcmF0ZVBhbGV0dGUgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0cmV0dXJuIHBhbGV0dGUob3B0aW9ucyk7XG5cdH07XG5cdFxuXHQkc2NvcGUuYnVpbGRJbmZvID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG9wdGlvbnMgPSB7XG5cdFx0XHRtYWluSGV4IDogJHNjb3BlLnZlcnNpb25Db2xvclxuXHRcdH07XG4gICAgICAgIFxuXHRcdCRzY29wZS52ZXJzaW9uU2NoZW1lID0gdmVyc2lvblBhbGV0dGUob3B0aW9ucyk7XG4gICAgICAgIFxuXHRcdCQoJ2JvZHknKS5jc3MoJ292ZXJmbG93JywnaGlkZGVuJyk7XG4gICAgICAgIFxuXHRcdCQoJy5hYm91dCcpLmZhZGVJbigyMDApO1xuICAgICAgICBcblx0XHQkKCcuYWJvdXQtY29udGFpbmVyJykuc2hvdygnZHJvcCcsIHsgZGlyZWN0aW9uOidkb3duJyB9LCAyMDAsIGZ1bmN0aW9uKCkge1xuXHRcdFx0JCgnYm9keScpLmNzcygnb3ZlcmZsb3cnLCdhdXRvJyk7XG5cdFx0fSk7XG5cdH07XG5cdFxuXHQkc2NvcGUuY2xvc2VBYm91dCA9IGZ1bmN0aW9uKCRldmVudCkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gJGV2ZW50LnRhcmdldC5jbGFzc05hbWU7XG4gICAgICAgIFxuICAgICAgICBpZiAodGFyZ2V0ID09PSBcInBhbmVsIGFib3V0XCIpIHtcbiAgICAgICAgICAgICQoJy5hYm91dCcpLmNzcygnY3Vyc29yJywgJ2F1dG8nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJCgnYm9keScpLmNzcygnb3ZlcmZsb3cnLCdoaWRkZW4nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJCgnLmFib3V0JykuZmFkZU91dCgyMDApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKCcuYWJvdXQtY29udGFpbmVyJykuaGlkZSgnZHJvcCcsIHsgZGlyZWN0aW9uOidkb3duJyB9LCAyMDAsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmNzcygnb3ZlcmZsb3cnLCdhdXRvJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXHR9O1xuICAgIFxuICAgICRzY29wZS5jaGFuZ2VDdXJzb3IgPSBmdW5jdGlvbigkZXZlbnQpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9ICRldmVudC50YXJnZXQuY2xhc3NOYW1lO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRhcmdldCA9PT0gXCJwYW5lbCBhYm91dFwiKSB7XG4gICAgICAgICAgICAkKCcuYWJvdXQnKS5jc3MoJ2N1cnNvcicsICd1cmwoYXNzZXRzL2ltYWdlcy9jbG9zZS5naWYpLCBjcm9zc2hhaXInKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQoJy5hYm91dCcpLmNzcygnY3Vyc29yJywgJ2F1dG8nKTtcbiAgICAgICAgfVxuXHR9O1xuXHRcblx0JHNjb3BlLnNlbGVjdEhleFN0cmluZyA9IGZ1bmN0aW9uKCRldmVudCkge1xuXHRcdHZhciByYW5nZSwgc2VsZWN0aW9uO1xuXHRcdHZhciBlbGVtZW50Q2xhc3MgPSAkZXZlbnQuY3VycmVudFRhcmdldC5jbGFzc05hbWU7XG5cdFx0dmFyIGVsZW1lbnQgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoZWxlbWVudENsYXNzKVswXTtcblxuXHRcdGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKSB7XG5cdFx0XHRzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7XG5cdFx0XHRyYW5nZSAgICAgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xuICAgICAgICAgICAgXG5cdFx0XHRyYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoZWxlbWVudCk7XG5cdFx0XHRzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7XG5cdFx0XHRzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xuXHRcdH0gZWxzZSBpZiAoZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UpIHtcblx0XHRcdHJhbmdlID0gZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKTtcbiAgICAgICAgICAgIFxuXHRcdFx0cmFuZ2UubW92ZVRvRWxlbWVudFRleHQoZWxlbWVudCk7XG5cdFx0XHRyYW5nZS5zZWxlY3QoKTtcblx0XHR9XHRcblx0fTtcblx0XG5cdC8vQ29weSB0byBjbGlwYm9hcmQgcGx1Z2luXG5cdHZhciBjbGlwYm9hcmQgPSBuZXcgQ2xpcGJvYXJkKCcuY29sb3InKTtcblx0XG5cdGNsaXBib2FyZC5vbignc3VjY2VzcycsIGZ1bmN0aW9uKGUpIHtcblx0XHR2YXIgJGVsZW1lbnQgPSAkKGUudHJpZ2dlcik7XG5cdFx0dmFyIGNvbG9yICAgID0gJGVsZW1lbnQuYXR0cignY2xhc3MnKS5yZXBsYWNlKCcgY29sb3InLCcnKTtcblxuXHRcdGlmICghJCgnLicgKyBjb2xvciArICcuaGV4IC5oaW50JylbMF0pIHtcblx0XHRcdCQoJy4nICsgY29sb3IgKyAnLmhleCcpLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJoaW50XCI+Y29waWVkIHRvIGNsaXBib2FyZDwvc3Bhbj4nKS5zaG93KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKCcuaGludCcpLmZhZGVPdXQoMTAwMCwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0JCh0aGlzKS5yZW1vdmUoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH0pO1xuXG5cdGNsaXBib2FyZC5vbignZXJyb3InLCBmdW5jdGlvbihlKSB7XG5cdFx0dmFyICRlbGVtZW50ID0gJChlLnRyaWdnZXIpO1xuXHRcdHZhciBjb2xvciAgICA9ICRlbGVtZW50LmF0dHIoJ2NsYXNzJykucmVwbGFjZSgnIGNvbG9yJywnJyk7XG5cdFx0XG5cdFx0aWYgKCEkKCcuJyArIGNvbG9yICsgJy5oZXggLmhpbnQnKVswXSkge1xuXHRcdFx0JCgnLicgKyBjb2xvciArICcuaGV4JykuYXBwZW5kKCc8c3BhbiBjbGFzcz1cImhpbnRcIj5jdHJsK2MgdG8gY29weTwvc3Bhbj4nKS5zaG93KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKCcuaGludCcpLmZhZGVPdXQoMTAwMCwgZnVuY3Rpb24oKXtcblx0XHRcdFx0XHQkKHRoaXMpLnJlbW92ZSgpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSk7XG5cdFxuXHR3aW5kb3cub25wb3BzdGF0ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0aWYgKGV2ZW50LnN0YXRlICE9PSBudWxsKSB7XG5cdFx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkc2NvcGUuc2NoZW1lID0gZXZlbnQuc3RhdGUuc2NoZW1lO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xuXHRcblx0LyoqXG5cdCAqIENoZWNrcyBVUkwgZm9yIGhleCBjb2Rlc1xuXHQgKiBcblx0ICogQHJldHVybnMge29ian0gVGhlIHNjaGVtZSBvYmplY3QgYmFzZWQgb24gdGhlIFVSTCBcblx0ICovXG5cdGZ1bmN0aW9uIGNoZWNrRm9yVXJsVmFsdWVzKCkge1xuXHRcdHZhciBzY2hlbWUgICAgICA9IG51bGw7XG5cdFx0dmFyIGN1cnJlbnRQYXRoID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lO1xuXHRcdHZhciBwYXRoQXJyYXkgICA9IGN1cnJlbnRQYXRoLnNwbGl0KCcvJyk7XG5cdFx0dmFyIGhleFN0cmluZyAgID0gcGF0aEFycmF5W3BhdGhBcnJheS5sZW5ndGggLSAxXTtcbiAgICAgICAgXG5cdFx0aWYgKGhleFN0cmluZy5tYXRjaCgvXigoW2EtZkEtRjAtOV0pezZ9KS0oKFthLWZBLUYwLTldKXs2fSktKChbYS1mQS1GMC05XSl7Nn0pLSgoW2EtZkEtRjAtOV0pezZ9KSQvaWcpICE9PSBudWxsKSB7XG5cdFx0XHR2YXIgY29sb3JzQXJyYXkgPSBoZXhTdHJpbmcuc3BsaXQoJy0nKTtcbiAgICAgICAgICAgIFxuXHRcdFx0c2NoZW1lID0ge1xuXHRcdFx0XHRtYWluIDogJyMnICsgY29sb3JzQXJyYXlbMF0sXG5cdFx0XHRcdGNvbXBsZW1lbnRhcnkgOiAnIycgKyBjb2xvcnNBcnJheVsxXSxcblx0XHRcdFx0ZGFyayA6ICcjJyArIGNvbG9yc0FycmF5WzJdLFxuXHRcdFx0XHRsaWdodCA6ICcjJyArIGNvbG9yc0FycmF5WzNdLFxuXHRcdFx0XHRub0hhc2ggOiB7XG5cdFx0XHRcdFx0bWFpbiA6IGNvbG9yc0FycmF5WzBdLFxuXHRcdFx0XHRcdGNvbXBsZW1lbnRhcnkgOiBjb2xvcnNBcnJheVsxXSxcblx0XHRcdFx0XHRkYXJrIDogY29sb3JzQXJyYXlbMl0sXG5cdFx0XHRcdFx0bGlnaHQgOiBjb2xvcnNBcnJheVszXVxuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gc2NoZW1lO1xuXHR9XG5cdFxuXHQvKipcblx0ICogR2VuZXJhdGVzIGNvbG9yIHBhbGV0dGUgYmFzZWQgb24gc2NoZW1lIG9iamVjdCBnZW5lcmF0ZWQgYnkgVVJMXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7b2JqfSBvcHRpb25zIFRoZSBzY2hlbWUgb2JqZWN0IGdlbmVyYXRlZCBieSBVUkxcblx0ICogICAgICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge29ian0gVGhlIGNvbXBsZXRlIHNjaGVtZSBvYmplY3Rcblx0ICovXG5cdGZ1bmN0aW9uIGdlbmVyYXRlUGFsZXR0ZUZyb21VUkwob3B0aW9ucykge1xuXHRcdHZhciBzY2hlbWUgPSBjb2xvcmlwc3VtLmdlbmVyYXRlUGFsZXR0ZUZyb21VUkwob3B0aW9ucyk7XG5cdFx0XG5cdFx0aGlzdG9yeVJlZnJlc2goc2NoZW1lLCAnQ29sb3JzIGZvciBkZXZzJyk7XG5cdFx0XG5cdFx0cmV0dXJuIHNjaGVtZTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhIHJhbmRvbSBjb2xvciBzY2hlbWVcblx0ICogXG5cdCAqIEByZXR1cm5zIHtvYmp9IEEgY29tcGxldGUgc2NoZW1lIG9iamVjdFxuXHQgKi9cblx0ZnVuY3Rpb24gcmFuZG9tU2NoZW1lKCkge1xuXHRcdHZhciBzY2hlbWUgPSBjb2xvcmlwc3VtLnJhbmRvbSgpO1xuXHRcdFxuXHRcdGhpc3RvcnlSZWZyZXNoKHNjaGVtZSwgJ0NvbG9ycyBmb3IgZGV2cycpO1xuXHRcdFxuXHRcdHJldHVybiBzY2hlbWU7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYSBjb2xvciBwYWxldHRlIGJhc2VkIG9uIGJhc2UgY29sb3JzXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7b2JqfSBvcHRpb25zIHttYWluSGV4LCBkYXJrSGV4LCBsaWdodEhleH1cblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7b2JqfSBBIGNvbXBsZXRlIHNjaGVtZSBvYmplY3Rcblx0ICovXG5cdGZ1bmN0aW9uIHBhbGV0dGUob3B0aW9ucykge1xuXHRcdHZhciBzY2hlbWUgPSBjb2xvcmlwc3VtLnBhbGV0dGUob3B0aW9ucyk7XG5cdFx0XG5cdFx0aGlzdG9yeVJlZnJlc2goc2NoZW1lLCAnQ29sb3JzIGZvciBkZXZzJyk7XG5cdFx0XG5cdFx0cmV0dXJuIHNjaGVtZTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEdlbmVyYXRlcyB0aGUgY3VycmVudCB2ZXJzaW9uIHBhbGV0dGVcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtvYmp9IG9wdGlvbnMge21haW5IZXgsIGRhcmtIZXgsIGxpZ2h0SGV4fVxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7b2JqfSBBIGNvbXBsZXRlIHNjaGVtZSBvYmplY3Rcblx0ICovXG5cdGZ1bmN0aW9uIHZlcnNpb25QYWxldHRlKG9wdGlvbnMpIHtcblx0XHR2YXIgc2NoZW1lID0gY29sb3JpcHN1bS5wYWxldHRlKG9wdGlvbnMpO1xuXHRcdFxuXHRcdHJldHVybiBzY2hlbWU7XG5cdH1cblx0XG5cdC8qKlxuICAgICogTWFuYWdlIEhUTUw1IGhpc3RvcnkgdXJsIGNoYW5nZSAocHVzaCBvciByZXBsYWNlKVxuICAgICpcblx0KiBAcGFyYW0ge29ian0gc2NoZW1lIFRoZSBjdXJyZW50IHNjaGVtZVxuXHQqIEBwYXJhbSB7c3RyfSB0aXRsZSAgVGhlIHBhZ2UgdGl0bGVcbiAgICAqL1xuXHRmdW5jdGlvbiBoaXN0b3J5UmVmcmVzaChzY2hlbWUsIHRpdGxlKSB7XG5cdFx0dmFyIGN1cnJlbnRQYXRoID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lO1xuXHRcdHZhciBwYXRoQXJyYXkgICA9IGN1cnJlbnRQYXRoLnNwbGl0KCcvJyk7XG5cdFx0dmFyIGN1cnJlbnRVUkwgID0gJy8nK3BhdGhBcnJheVtwYXRoQXJyYXkubGVuZ3RoIC0gMV07XG5cdFx0dmFyIG5ld1VSTCAgICAgID0gJy8nK3NjaGVtZS5ub0hhc2gubWFpbisnLScrc2NoZW1lLm5vSGFzaC5jb21wbGVtZW50YXJ5KyctJytzY2hlbWUubm9IYXNoLmRhcmsrJy0nK3NjaGVtZS5ub0hhc2gubGlnaHQrJyc7XG5cdFx0XG5cdFx0aWYgKG5ld1VSTCA9PT0gY3VycmVudFVSTCkge1xuXHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe3NjaGVtZTogc2NoZW1lfSwgdGl0bGUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRoaXN0b3J5LnB1c2hTdGF0ZSh7c2NoZW1lOiBzY2hlbWV9LCB0aXRsZSwgbmV3VVJMKTtcblx0XHR9XG5cdH1cbn1dKTtcblxuXG4vKipcbiogRGlyZWN0aXZlIGZvciBzcGVjdHJ1bSBqUXVlcnkgcGx1Z2luXG4qXG4qL1xuYXBwLmRpcmVjdGl2ZSgnc3BlY3RydW0nLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblxuICAgICAgICAgICAgJChlbGVtZW50KS5zcGVjdHJ1bShzY29wZS4kZXZhbChhdHRycy5zcGVjdHJ1bSkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBPdmVycmlkZSBzcGVjdHJ1bSBuYXRpdmUgcG9zaXRpb25pbmdcbiAgICAgICAgICAgICQoZWxlbWVudCkub24oJ3JlZmxvdy5zcGVjdHJ1bScsIGZ1bmN0aW9uKGUpIHsgXG4gICAgICAgICAgICAgICAgc2V0UGlja2VyUG9zaXRpb24oJCgnLnNwLWNvbnRhaW5lcicpLCAkKCcuc3AtcmVwbGFjZXInKSk7XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuXHRcdFx0JChlbGVtZW50KS5vbignY2hhbmdlLnNwZWN0cnVtJywgZnVuY3Rpb24oZSwgdGlueWNvbG9yKSB7IFxuXHRcdFx0XHR2YXIgb3B0aW9ucyA9IHtcblx0XHRcdFx0XHRtYWluSGV4IDogdGlueWNvbG9yLnRvSGV4U3RyaW5nKClcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0c2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHNjb3BlLnNjaGVtZSA9IHNjb3BlLmdlbmVyYXRlUGFsZXR0ZShvcHRpb25zKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuXHRcdFx0c2NvcGUuJHdhdGNoKCdzY2hlbWUnLCBmdW5jdGlvbihjb2xvcikge1xuXHRcdFx0XHQkKGVsZW1lbnQpLnNwZWN0cnVtKFwic2V0XCIsIGNvbG9yLm1haW4pO1xuXHRcdFx0XHRcblx0XHRcdFx0JCgnLnNwLXByZXZpZXcnKS5jc3Moe1xuXHRcdFx0XHRcdCdjb2xvcicgOiBjb2xvci51aUNvbG9ycy50ZXh0c1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdCQoJy5zcC1wcmV2aWV3JykuY3NzKHtcblx0XHRcdFx0XHQnYmFja2dyb3VuZCcgOiBjb2xvci5tYWluXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0IHRoZSBwb3NpdGlvbiBvZiB0aGUgY29sb3IgcGlja2VyIChvdmVycmlkZSBzcGVjdHJ1bSBuYXRpdmUgcG9zaXRpb25pbmcpXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSB7b2JqfSBwaWNrZXIgalF1ZXJ5IG9iamVjdDogVGhlIGNvbG9yIHBpY2tlciBjb250YWluZXJcbiAgICAgICAgICAgICAqIEBwYXJhbSB7b2JqfSBpbnB1dCAgalF1ZXJ5IG9iamVjdDogVGhlIGNvbG9yIHBpY2tlciBpbnB1dCByZXBsYWNlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBzZXRQaWNrZXJQb3NpdGlvbihwaWNrZXIsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRwV2lkdGggICAgID0gcGlja2VyLm91dGVyV2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgZHBIZWlnaHQgICAgPSBwaWNrZXIub3V0ZXJIZWlnaHQoKTtcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXRIZWlnaHQgPSBpbnB1dC5vdXRlckhlaWdodCgpO1xuICAgICAgICAgICAgICAgIHZhciBkb2MgICAgICAgICA9IHBpY2tlclswXS5vd25lckRvY3VtZW50O1xuICAgICAgICAgICAgICAgIHZhciBkb2NFbGVtICAgICA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgdmFyIHZpZXdXaWR0aCAgID0gZG9jRWxlbS5jbGllbnRXaWR0aCArICQoZG9jKS5zY3JvbGxMZWZ0KCk7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCAgICAgID0gaW5wdXQub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgb2Zmc2V0LmxlZnQgICAgKz0gODQ7XG4gICAgICAgICAgICAgICAgb2Zmc2V0LnRvcCAgICAgKz0gaW5wdXRIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICBvZmZzZXQubGVmdCAgICAgPSAob2Zmc2V0LmxlZnQgKyBkcFdpZHRoID4gdmlld1dpZHRoICYmIHZpZXdXaWR0aCA+IGRwV2lkdGgpID8gTWF0aC5hYnMob2Zmc2V0LmxlZnQgLSBkcFdpZHRoKSA6IG9mZnNldC5sZWZ0O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIG9mZnNldC50b3AgICAgICA9IE1hdGguYWJzKG9mZnNldC50b3AgLSA0MiAtIChkcEhlaWdodCAvIDIpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBwaWNrZXIuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogb2Zmc2V0LmxlZnQsXG4gICAgICAgICAgICAgICAgICAgIHRvcDogb2Zmc2V0LnRvcFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn0pO1xuXG4vKipcbiogRGlyZWN0aXZlIHRvIGZvY3VzIG9uIGFuIGVsZW1lbnRcbipcbiogQ2FuJ3QgZ2l2ZSBpc29sYXRlZCBzY29wZSBiZWNhdXNlIGl0IHdpbGwgcmVzdWx0IGluICRjb21waWxlOm11bHRpZGlyIGVycm9yXG4qL1xuYXBwLmRpcmVjdGl2ZSgnc2V0Rm9jdXMnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIGVsZW1lbnRbMF0uZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH07XG59KTsiLCJhcHAuc2VydmljZSgnY29sb3JpcHN1bScsIGZ1bmN0aW9uKCkge1xuICAgIFxuXHR2YXIgc2VsZiA9IHRoaXM7XG5cdFxuXHR2YXIgcGFsZXR0ZVRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiB7XG5cdFx0XHRtYWluIDogJycsXG5cdFx0XHRjb21wbGVtZW50YXJ5IDogJycsXG5cdFx0XHRkYXJrIDogJycsXG5cdFx0XHRsaWdodCA6ICcnLFxuXHRcdFx0bm9IYXNoIDoge1xuXHRcdFx0XHRtYWluIDogJycsXG5cdFx0XHRcdGNvbXBsZW1lbnRhcnkgOiAnJyxcblx0XHRcdFx0ZGFyayA6ICcnLFxuXHRcdFx0XHRsaWdodCA6ICcnXG5cdFx0XHR9LFxuXHRcdFx0bHVtaW5vY2l0eSA6IHtcblx0XHRcdFx0bWFpbiA6ICcnLFxuXHRcdFx0XHRjb21wbGVtZW50YXJ5IDogJycsXG5cdFx0XHRcdGRhcmsgOiAnJyxcblx0XHRcdFx0bGlnaHQgOiAnJ1xuXHRcdFx0fSxcblx0XHRcdHVpQ29sb3JzIDoge1xuXHRcdFx0XHRiYWNrZ3JvdW5kIDogJycsXG5cdFx0XHRcdGhleCA6ICcnLFxuXHRcdFx0XHR0ZXh0cyA6ICcnXG5cdFx0XHR9XG5cdFx0fTtcblx0fTtcblx0XG5cdHRoaXMucmFuZG9tID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG1haW5IZXggID0gcmFuZG9tSGV4KCk7XG5cdFx0dmFyIGRhcmtIZXggID0gcmFuZG9tU2hhZGVzKHRydWUpO1xuXHRcdHZhciBsaWdodEhleCA9IHJhbmRvbVNoYWRlcyhmYWxzZSk7XG5cdFxuXHRcdHZhciBwYWxldHRlID0gc2VsZi5wYWxldHRlKHtcblx0XHRcdG1haW5IZXggOiBtYWluSGV4LFxuXHRcdFx0ZGFya0hleCA6IGRhcmtIZXgsXG5cdFx0XHRsaWdodEhleCA6IGxpZ2h0SGV4XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIHBhbGV0dGU7XG5cdH07XG5cdFxuXHR0aGlzLnBhbGV0dGUgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dmFyIGRlZmF1bHRzID0ge1xuXHRcdFx0bWFpbkhleCA6ICcjRkZGRkZGJyxcblx0XHRcdGRhcmtIZXggOiAnIzQyNDI0MicsXG5cdFx0XHRsaWdodEhleCA6ICcjRkFGQUZBJ1xuXHRcdH1cbiAgICAgICAgXG5cdFx0dmFyIG9wdHMgICAgPSBleHRlbmQoZGVmYXVsdHMsIG9wdGlvbnMpO1xuXHRcdHZhciBwYWxldHRlID0gbmV3IHBhbGV0dGVUZW1wbGF0ZSgpO1xuXHRcdFxuXHRcdHBhbGV0dGUubWFpbiAgICAgICAgICAgID0gb3B0cy5tYWluSGV4O1xuXHRcdHBhbGV0dGUubm9IYXNoLm1haW4gICAgID0gY3V0SGV4KHBhbGV0dGUubWFpbikudG9VcHBlckNhc2UoKTtcblx0XHRwYWxldHRlLmx1bWlub2NpdHkubWFpbiA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5tYWluKTtcblx0XHRcblx0XHRwYWxldHRlLmNvbXBsZW1lbnRhcnkgICAgICAgICAgICA9IGZpbmRDb21wbGVtZW50YXJ5KG9wdHMubWFpbkhleCk7XG5cdFx0cGFsZXR0ZS5ub0hhc2guY29tcGxlbWVudGFyeSAgICAgPSBjdXRIZXgocGFsZXR0ZS5jb21wbGVtZW50YXJ5KS50b1VwcGVyQ2FzZSgpO1xuXHRcdHBhbGV0dGUubHVtaW5vY2l0eS5jb21wbGVtZW50YXJ5ID0gaGV4THVtaW5vY2l0eShwYWxldHRlLmNvbXBsZW1lbnRhcnkpO1xuXHRcdFxuXHRcdHBhbGV0dGUuZGFyayAgICAgICAgICAgID0gaGV4QmxlbmRPdmVybGF5KG9wdHMubWFpbkhleCwgMC4yLCBvcHRzLmRhcmtIZXgpO1xuXHRcdHBhbGV0dGUubm9IYXNoLmRhcmsgICAgID0gY3V0SGV4KHBhbGV0dGUuZGFyaykudG9VcHBlckNhc2UoKTtcblx0XHRwYWxldHRlLmx1bWlub2NpdHkuZGFyayA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5kYXJrKTtcblx0XHRcblx0XHRwYWxldHRlLmxpZ2h0ICAgICAgICAgICAgPSBoZXhCbGVuZE92ZXJsYXkob3B0cy5tYWluSGV4LCAwLjIsIG9wdHMubGlnaHRIZXgpO1xuXHRcdHBhbGV0dGUubm9IYXNoLmxpZ2h0ICAgICA9IGN1dEhleChwYWxldHRlLmxpZ2h0KS50b1VwcGVyQ2FzZSgpO1xuXHRcdHBhbGV0dGUubHVtaW5vY2l0eS5saWdodCA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5saWdodCk7XG5cblx0XHRwYWxldHRlLnVpQ29sb3JzID0gZXh0ZW5kKHBhbGV0dGUudWlDb2xvcnMsIGdlbmVyYXRlVUlDb2xvcnMocGFsZXR0ZS5tYWluKSk7XG5cdFx0XG5cdFx0cmV0dXJuIHBhbGV0dGU7XG5cdH07XG5cdFxuXHR0aGlzLmdlbmVyYXRlUGFsZXR0ZUZyb21VUkwgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dmFyIHBhbGV0dGUgPSBleHRlbmQobmV3IHBhbGV0dGVUZW1wbGF0ZSgpLCBvcHRpb25zKTtcblx0XHRcblx0XHRwYWxldHRlLmx1bWlub2NpdHkubWFpbiAgICAgICAgICA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5tYWluKTtcblx0XHRwYWxldHRlLmx1bWlub2NpdHkuY29tcGxlbWVudGFyeSA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5jb21wbGVtZW50YXJ5KTtcblx0XHRwYWxldHRlLmx1bWlub2NpdHkuZGFyayAgICAgICAgICA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5kYXJrKTtcblx0XHRwYWxldHRlLmx1bWlub2NpdHkubGlnaHQgICAgICAgICA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5saWdodCk7XG5cblx0XHRwYWxldHRlLnVpQ29sb3JzID0gZXh0ZW5kKHBhbGV0dGUudWlDb2xvcnMsIGdlbmVyYXRlVUlDb2xvcnMocGFsZXR0ZS5tYWluKSk7XG5cdFx0XG5cdFx0cmV0dXJuIHBhbGV0dGU7XG5cdH07XG5cdFxuXHR0aGlzLmhleFRvUkdCQSA9IGZ1bmN0aW9uKGhleCwgYWxwaGEpIHtcblx0XHRyZXR1cm4gaGV4VG9SR0JBKGhleCwgYWxwaGEpO1xuXHR9O1xuXHRcblx0dGhpcy5yZ2JhVG9IZXggPSBmdW5jdGlvbihyZ2JhLCBiYXNlUkdCKSB7XG5cdFx0cmV0dXJuIHJnYmFUb0hleChyZ2JhLCBiYXNlUkdCKTtcblx0fTtcblx0XG5cdHRoaXMuaGV4T3BhY2l0eSA9IGZ1bmN0aW9uKGhleCwgYWxwaGEsIGJhc2VIZXgpIHtcblx0XHRyZXR1cm4gaGV4T3BhY2l0eShoZXgsIGFscGhhLCBiYXNlSGV4KTtcblx0fTtcblx0XG5cdHRoaXMuaGV4QmxlbmRPdmVybGF5ID0gZnVuY3Rpb24oaGV4LCBhbHBoYSwgYmFzZUhleCkge1xuXHRcdHJldHVybiBoZXhCbGVuZE92ZXJsYXkoaGV4LCBhbHBoYSwgYmFzZUhleCk7XG5cdH07XG5cdFxuXHR0aGlzLmhleEx1bWlub2NpdHkgPSBmdW5jdGlvbihoZXgpIHtcblx0XHRyZXR1cm4gaGV4THVtaW5vY2l0eShoZXgpO1xuXHR9O1xuXHRcblx0LyoqXG5cdCAqIEZpbmQgY29tcGxlbWVudGFyeSBjb2xvciBcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtzdHJ9IGhleCBUaGUgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtzdHJ9ICAgVGhlIGNvbXBsZW1lbnRhcnkgY29sb3IgaGV4IHN0cmluZ1xuXHQgKi9cblx0ZnVuY3Rpb24gZmluZENvbXBsZW1lbnRhcnkoaGV4KSB7XG5cdFx0dmFyIGhleCAgICAgICAgICAgPSBoZXhTdHJpbmdUb2hleChoZXgpO1xuXHRcdHZhciBjb21wbGVtZW50YXJ5ID0gKDAwMDAwMCArICgoMHhmZmZmZmYgLSBoZXgpLnRvU3RyaW5nKDE2KSkpLnNsaWNlKC02KTtcbiAgICAgICAgXG5cdFx0d2hpbGUgKGNvbXBsZW1lbnRhcnkubGVuZ3RoIDwgNikge1xuXHRcdFx0Y29tcGxlbWVudGFyeSA9ICcwJyArIGNvbXBsZW1lbnRhcnk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiAnIycgKyBjb21wbGVtZW50YXJ5O1xuXHR9XG5cdFxuXHQvKipcblx0ICogUmVjcmVhdGVzIGJsZW5kIG1vZGUgbXVsdGlwbHkgYW5kIHJldHVybnMgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiBcblx0ICogQHBhcmFtICAge29ian0gICBiYXNlUkdCICAgT2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIFJHQiB2YWx1ZXMgb2YgdGhlIGJhc2UgY29sb3Jcblx0ICogQHBhcmFtICAge29ian0gICBjb2xvclJHQkEgT2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIFJHQkEgdmFsdWVzIG9mIHRoZSBibGVuZGVkIGNvbG9yXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7c3RyfSBUaGUgaGV4IGNvbG9yIHN0cmluZyBvZiB0aGUgcmVzdWx0aW5nIGNvbG9yXG5cdCAqL1xuXHRmdW5jdGlvbiBibGVuZE11bHRpcGx5KGJhc2VSR0IsIGNvbG9yUkdCQSkge1xuXHRcdHZhciBibGVuZCA9IHt9O1xuXHQgIFxuXHRcdGJsZW5kLnIgPSBNYXRoLnJvdW5kKCgyICogYmFzZVJHQi5yICogY29sb3JSR0JBLnIpIC8gMjU1KTtcblx0XHRibGVuZC5nID0gTWF0aC5yb3VuZCgoMiAqIGJhc2VSR0IuZyAqIGNvbG9yUkdCQS5nKSAvIDI1NSk7XG5cdFx0YmxlbmQuYiA9IE1hdGgucm91bmQoKDIgKiBiYXNlUkdCLmIgKiBjb2xvclJHQkEuYikgLyAyNTUpO1xuXHRcdGJsZW5kLmEgPSBjb2xvclJHQkEuYTtcblx0ICBcblx0XHRyZXR1cm4gcmdiYVRvSGV4KGJsZW5kLCBiYXNlUkdCKTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIFJlY3JlYXRlcyBibGVuZCBtb2RlIHNjcmVlbiBhbmQgcmV0dXJucyBoZXggY29sb3Igc3RyaW5nXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7b2JqfSAgIGJhc2VSR0IgICBPYmplY3QgdGhhdCBjb250YWlucyB0aGUgUkdCIHZhbHVlcyBvZiB0aGUgYmFzZSBjb2xvclxuXHQgKiBAcGFyYW0gICB7b2JqfSAgIGNvbG9yUkdCQSBPYmplY3QgdGhhdCBjb250YWlucyB0aGUgUkdCQSB2YWx1ZXMgb2YgdGhlIGJsZW5kZWQgY29sb3Jcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtzdHJ9IFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSByZXN1bHRpbmcgY29sb3Jcblx0ICovXG5cdGZ1bmN0aW9uIGJsZW5kU2NyZWVuKGJhc2VSR0IsIGNvbG9yUkdCQSkge1xuXHRcdHZhciBibGVuZCA9IHt9O1xuXHQgIFxuXHRcdGJsZW5kLnIgPSBNYXRoLnJvdW5kKCgxIC0gKCgxIC0gKGJhc2VSR0Iuci8yNTUpKSAqICgxIC0gKDIgKiBjb2xvclJHQkEuci8yNTUgLSAxKSkpKSAqIDI1NSk7XG5cdFx0YmxlbmQuZyA9IE1hdGgucm91bmQoKDEgLSAoKDEgLSAoYmFzZVJHQi5nLzI1NSkpICogKDEgLSAoMiAqIGNvbG9yUkdCQS5nLzI1NSAtIDEpKSkpICogMjU1KTtcblx0XHRibGVuZC5iID0gTWF0aC5yb3VuZCgoMSAtICgoMSAtIChiYXNlUkdCLmIvMjU1KSkgKiAoMSAtICgyICogY29sb3JSR0JBLmIvMjU1IC0gMSkpKSkgKiAyNTUpO1xuXHRcdGJsZW5kLmEgPSBjb2xvclJHQkEuYTtcblx0ICBcblx0XHRyZXR1cm4gcmdiYVRvSGV4KGJsZW5kLCBiYXNlUkdCKTtcblx0fVxuXHRcblx0LyoqXG4gICAgICogUmVjcmVhdGVzIGJsZW5kIG1vZGUgb3ZlcmxheSBhbmQgcmV0dXJucyBoZXggY29sb3Igc3RyaW5nXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7b2JqfSBiYXNlUkdCICAgT2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIFJHQiB2YWx1ZXMgb2YgdGhlIGJhc2UgY29sb3Jcblx0ICogQHBhcmFtICAge29ian0gY29sb3JSR0JBIE9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSBSR0JBIHZhbHVlcyBvZiB0aGUgYmxlbmRlZCBjb2xvclxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7c3RyfSBUaGUgaGV4IGNvbG9yIHN0cmluZyBvZiB0aGUgcmVzdWx0aW5nIGNvbG9yXG5cdCAqL1xuXHRmdW5jdGlvbiBibGVuZE92ZXJsYXkoYmFzZVJHQiwgY29sb3JSR0JBKSB7XG5cdFx0dmFyIGx1bWVuID0gcmdiTHVtaW5vY2l0eShiYXNlUkdCKTtcblx0XHR2YXIgYmxlbmQgPSAnJztcbiAgICAgICAgXG4gICAgICAgIC8vIEJsZW5kIG1vZGUgb3ZlcmxheSBpcyBtdWx0aXBseSBmb3IgZGFyayBjb2xvcnMgYW5kIHNjcmVlbiBmb3IgbGlnaHQgb25lc1xuXHRcdGlmIChsdW1lbiA8PSAwLjUpIHtcblx0XHRcdGJsZW5kID0gYmxlbmRNdWx0aXBseShiYXNlUkdCLCBjb2xvclJHQkEpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRibGVuZCA9IGJsZW5kU2NyZWVuKGJhc2VSR0IsIGNvbG9yUkdCQSk7XG5cdFx0fVxuXHQgIFxuXHRcdHJldHVybiBibGVuZDtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENhbGN1bGF0ZXMgdGhlIGx1bWlub2NpdHkgb2YgYSBjb2xvclxuXHQgKiBcblx0ICogQHBhcmFtICAge29ian0gICByZ2IgT2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIFJHQiB2YWx1ZXMgb2YgdGhlIGNvbG9yXG5cdCAqICAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7bnVtfSBUaGUgbHVtaW5vY2l0eSBvZiBhIGNvbG9yICgwLTEpXG5cdCAqL1xuXHRmdW5jdGlvbiByZ2JMdW1pbm9jaXR5KHJnYikge1xuXHRcdHJldHVybiAoKHJnYi5yICsgcmdiLmcgKyByZ2IuYikvMykvMjU1O1xuXHR9XG5cdFxuXHQvKipcblx0ICogQ29udmVydHMgYW4gUkdCQSBjb2xvciB0byBoZXggc3RyaW5nIGdldHRpbmcgaW50byBjb25zaWRlcmF0aW9uIHRoZSBiYXNlIGNvbG9yXG5cdCAqIFJlcHJvZHVjZXMgaW4gaGV4IHRoZSBzYW1lIHZpc3VhbCByZXN1bHQgYXMgYW4gUkdCQSBjb2xvciBhYm92ZSBhbm90aGVyIGJhc2UgY29sb3Jcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtvYmp9ICAgcmdiYSAgICBPYmplY3QgdGhhdCBjb250YWlucyB0aGUgUkdCQSB2YWx1ZXMgb2YgdGhlIGNvbG9yXG5cdCAqIEBwYXJhbSAgIHtvYmp9ICAgYmFzZVJHQiBPYmplY3QgdGhhdCBjb250YWlucyB0aGUgUkdCIHZhbHVlcyBvZiB0aGUgYmFzZSBjb2xvclxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtzdHJ9IFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSByZXN1bHRpbmcgY29sb3Jcblx0ICovXG5cdGZ1bmN0aW9uIHJnYmFUb0hleChyZ2JhLCBiYXNlUkdCKSB7XG5cdFx0dmFyIHJnYiA9IHt9O1xuXHRcdFxuXHRcdHJnYi5yID0gKDEgLSByZ2JhLmEpICogYmFzZVJHQi5yICsgcmdiYS5hICogcmdiYS5yO1xuXHRcdHJnYi5nID0gKDEgLSByZ2JhLmEpICogYmFzZVJHQi5nICsgcmdiYS5hICogcmdiYS5nO1xuXHRcdHJnYi5iID0gKDEgLSByZ2JhLmEpICogYmFzZVJHQi5iICsgcmdiYS5hICogcmdiYS5iO1xuXHRcdFxuXHRcdHJldHVybiByZ2JUb0hleChyZ2IuciwgcmdiLmcsIHJnYi5iKTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENvbnZlcnRzIGhleCBjb2xvciB0byBSR0JBXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7c3RyfSBoZXggICBUaGUgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiBAcGFyYW0gICB7bnVtfSBhbHBoYSBUaGUgZGVzaXJlZCBBbHBoYSBjaGFubmVsIHZhbHVlIChtdXN0IGJlIDAtMSlcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge29ian0gQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIFJHQkEgdmFsdWVzIG9mIHRoZSBjb2xvclxuXHQgKi9cblx0ZnVuY3Rpb24gaGV4VG9SR0JBKGhleCwgYWxwaGEpIHtcblx0XHR2YXIgcmdiYSA9IHtcblx0XHRcdHI6IGhleFRvUihoZXgpLFxuXHRcdFx0ZzogaGV4VG9HKGhleCksXG5cdFx0XHRiOiBoZXhUb0IoaGV4KSxcblx0XHRcdGE6IGFscGhhXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gcmdiYTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIFJldHJpZXZlcyB0aGUgUiBjaGFubmVsIHZhbHVlIGZyb20gYSBoZXggY29sb3Igc3RyaW5nXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7c3RyfSBoZXggVGhlIGhleCBjb2xvciBzdHJpbmdcblx0ICogICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7aW50fSBUaGUgUiBjaGFubmVsIHZhbHVlIG9mIHRoZSBjb2xvclxuXHQgKi9cblx0ZnVuY3Rpb24gaGV4VG9SKGhleCkge1xuXHRcdHJldHVybiBwYXJzZUludCgoY3V0SGV4KGhleCkpLnN1YnN0cmluZygwLDIpLDE2KTtcblx0fVxuXHRcbiAgICAvKipcblx0ICogUmV0cmlldmVzIHRoZSBHIGNoYW5uZWwgdmFsdWUgZnJvbSBhIGhleCBjb2xvciBzdHJpbmdcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtzdHJ9IGhleCBUaGUgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtpbnR9IFRoZSBHIGNoYW5uZWwgdmFsdWUgb2YgdGhlIGNvbG9yXG5cdCAqL1xuXHRmdW5jdGlvbiBoZXhUb0coaGV4KSB7XG5cdFx0cmV0dXJuIHBhcnNlSW50KChjdXRIZXgoaGV4KSkuc3Vic3RyaW5nKDIsNCksMTYpO1xuXHR9XG5cdFxuICAgIC8qKlxuXHQgKiBSZXRyaWV2ZXMgdGhlIEIgY2hhbm5lbCB2YWx1ZSBmcm9tIGEgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiBcblx0ICogQHBhcmFtICAge3N0cn0gaGV4IFRoZSBoZXggY29sb3Igc3RyaW5nXG5cdCAqICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge2ludH0gVGhlIEIgY2hhbm5lbCB2YWx1ZSBvZiB0aGUgY29sb3Jcblx0ICovXG5cdGZ1bmN0aW9uIGhleFRvQihoZXgpIHtcblx0XHRyZXR1cm4gcGFyc2VJbnQoKGN1dEhleChoZXgpKS5zdWJzdHJpbmcoNCw2KSwxNik7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBSZXR1cm5zIGEgaGV4IGNvbG9yIHN0cmluZyB3aXRob3V0IHRoZSAnIycgY2hhcmFjdGVyIChpZiBpdCBleGlzdHMpXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7c3RyfSAgIGhleCBUaGUgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiAgICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge3N0cn0gVGhlIGhleCBjb2xvciBzdHJpbmcgd2l0aG91dCB0aGUgJyMnIGNoYXJhY3RlclxuXHQgKi9cblx0ZnVuY3Rpb24gY3V0SGV4KGhleCkge1xuXHRcdHJldHVybiAoaGV4LmNoYXJBdCgwKT09XCIjXCIpID8gaGV4LnN1YnN0cmluZygxLDcpOmhleDtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENvbnZlcnRzIGhleCBjb2xvciBzdHJpbmcgdG8gaGV4IG51bWJlclxuXHQgKiBcblx0ICogQHBhcmFtICAge3N0cn0gICBoZXhTdHJpbmcgVGhlIGhleCBjb2xvciBzdHJpbmdcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtpbnR9IFRoZSBoZXggY29sb3Jcblx0ICovXG5cdGZ1bmN0aW9uIGhleFN0cmluZ1RvaGV4KGhleFN0cmluZykge1xuXHRcdHJldHVybiBwYXJzZUludChoZXhTdHJpbmcucmVwbGFjZSgvXiMvLCAnJyksIDE2KTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENvbnZlcnRzIFJHQiBjaGFubmVscyB0byBoZXggY29sb3Igc3RyaW5nXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7aW50fSBSIFRoZSBSIGNoYW5uZWxcblx0ICogQHBhcmFtICAge2ludH0gRyBUaGUgRyBjaGFubmVsXG5cdCAqIEBwYXJhbSAgIHtpbnR9IEIgVGhlIEIgY2hhbm5lbFxuXHQgKiAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7c3RyfSAgIFRoZSBoZXggY29sb3Igc3RyaW5nXG5cdCAqL1xuXHRmdW5jdGlvbiByZ2JUb0hleChSLEcsQikge1xuXHRcdHJldHVybiAnIycgKyB0b0hleChSKSArIHRvSGV4KEcpICsgdG9IZXgoQik7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIG51bWJlciB0byBoZXhcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtpbnR9IG4gVGhlIG51bWJlclxuXHQgKiAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7c3RyfSAgIFRoZSBoZXggY29kZVxuXHQgKi9cblx0ZnVuY3Rpb24gdG9IZXgobikge1xuXHRcdG4gPSBwYXJzZUludChuLDEwKTtcblx0XHRpZiAoaXNOYU4obikpIHJldHVybiBcIjAwXCI7XG5cdFx0biA9IE1hdGgubWF4KDAsTWF0aC5taW4obiwyNTUpKTtcblx0XHRyZXR1cm4gXCIwMTIzNDU2Nzg5QUJDREVGXCIuY2hhckF0KChuLW4lMTYpLzE2KVxuXHRcdFx0KyBcIjAxMjM0NTY3ODlBQkNERUZcIi5jaGFyQXQobiUxNik7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHJhbmRvbUhleCgpIHtcblx0XHR2YXIgcmFuZG9tID0gJyc7XG4gICAgICAgIFxuXHRcdHdoaWxlIChyYW5kb20ubGVuZ3RoIDwgNikge1xuXHRcdFx0cmFuZG9tICs9IChNYXRoLnJhbmRvbSgpKS50b1N0cmluZygxNikuc3Vic3RyKC02KS5zdWJzdHIoLTEpO1xuXHRcdH1cbiAgICAgICAgXG5cdFx0cmV0dXJuICcjJyArIHJhbmRvbTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhIHJhbmRvbSBzaGFkZSAoZGFyayBvciBsaWdodCkgb2YgYSBwcmVkZWZpbmVkIGNvbG9yXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7Ym9vfSBkYXJrIEJvb2xlYW4gdmFsdWUgZm9yIHNldHRpbmcgZGFyayBvciBsaWdodCBjb2xvclxuXHQgKiAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7c3RyfSAgIFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSByZXN1bHRpbmcgc2hhZGVcblx0ICovXG5cdGZ1bmN0aW9uIHJhbmRvbVNoYWRlcyhkYXJrKSB7XG5cdFx0dmFyIHBlcmNlbnQgPSBNYXRoLnJhbmRvbSgpO1xuXHRcdHZhciBjb2xvciAgID0gJyNFRUVFRUUnXG4gICAgICAgIFxuXHRcdGlmIChkYXJrKSB7XG5cdFx0XHRjb2xvciAgID0gJyM3Nzc3NzcnO1xuXHRcdFx0cGVyY2VudCA9IC0gcGVyY2VudDtcblx0XHR9XG5cdFx0XG5cdFx0dmFyIGYgPSBwYXJzZUludChjb2xvci5zbGljZSgxKSwxNiksdD1wZXJjZW50PDA/MDoyNTUscD1wZXJjZW50PDA/cGVyY2VudCotMTpwZXJjZW50LFI9Zj4+MTYsRz1mPj44JjB4MDBGRixCPWYmMHgwMDAwRkY7XG4gICAgICAgIFxuXHRcdHJldHVybiBcIiNcIisoMHgxMDAwMDAwKyhNYXRoLnJvdW5kKCh0LVIpKnApK1IpKjB4MTAwMDArKE1hdGgucm91bmQoKHQtRykqcCkrRykqMHgxMDArKE1hdGgucm91bmQoKHQtQikqcCkrQikpLnRvU3RyaW5nKDE2KS5zbGljZSgxKTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhIGhleCBjb2xvciB0aGF0IGVtdWxhdGVzIHRoZSB2aXN1YWwgcmVzdWx0IG9mIGEgY29sb3IgKHdpdGggb3BhY2l0eSkgb3ZlciBhbm90aGVyXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7c3RyfSBoZXggICAgIFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSBjb2xvclxuXHQgKiBAcGFyYW0gICB7aW50fSBhbHBoYSAgIFRoZSBBbHBoYSBjaGFubmVsIHZhbHVlIHdlIGRlc2lyZVxuXHQgKiBAcGFyYW0gICB7c3RyfSBiYXNlSGV4IFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSBiYXNlIGNvbG9yXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtzdHJ9IFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSByZXN1bHRpbmcgY29sb3Jcblx0ICovXG5cdGZ1bmN0aW9uIGhleE9wYWNpdHkoaGV4LCBhbHBoYSwgYmFzZUhleCkge1xuXHRcdHZhciByZ2JhICAgICA9IGhleFRvUkdCQShoZXgsIGFscGhhKTtcblx0XHR2YXIgYmFzZVJHQkEgPSBoZXhUb1JHQkEoYmFzZUhleCwgMSk7XG5cdFx0XG5cdFx0cmV0dXJuIHJnYmFUb0hleChyZ2JhLCBiYXNlUkdCQSk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYSBoZXggY29sb3IgdGhhdCBlbXVsYXRlcyB0aGUgdmlzdWFsIHJlc3VsdCBvZiBvdmVybGF5IGJsZW5kIG1vZGVcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtzdHJ9IGhleCAgICAgVGhlIGhleCBjb2xvciBzdHJpbmcgb2YgdGhlIGNvbG9yXG5cdCAqIEBwYXJhbSAgIHtpbnR9IGFscGhhICAgVGhlIEFscGhhIGNoYW5uZWwgdmFsdWUgd2UgZGVzaXJlXG5cdCAqIEBwYXJhbSAgIHtzdHJ9IGJhc2VIZXggVGhlIGhleCBjb2xvciBzdHJpbmcgb2YgdGhlIGJhc2UgY29sb3Jcblx0ICogICAgICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge3N0cn0gVGhlIGhleCBjb2xvciBzdHJpbmcgb2YgdGhlIHJlc3VsdGluZyBjb2xvclxuXHQgKi9cblx0ZnVuY3Rpb24gaGV4QmxlbmRPdmVybGF5KGhleCwgYWxwaGEsIGJhc2VIZXgpIHtcblx0XHR2YXIgcmdiYSAgICAgPSBoZXhUb1JHQkEoaGV4LCBhbHBoYSk7XG5cdFx0dmFyIGJhc2VSR0JBID0gaGV4VG9SR0JBKGJhc2VIZXgsIDEpO1xuXHRcdFxuXHRcdHJldHVybiBibGVuZE92ZXJsYXkoYmFzZVJHQkEsIHJnYmEpO1xuXHR9XG5cdFxuICAgIC8qKlxuXHQgKiBDYWxjdWxhdGVzIHRoZSBsdW1pbm9jaXR5IG9mIGEgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiBcblx0ICogQHBhcmFtICAge3N0cn0gaGV4ICAgICBUaGUgaGV4IGNvbG9yIHN0cmluZyBcblx0ICogICAgICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge2ludH0gVGhlIGx1bWlub2NpdHkgb2YgdGhlIGNvbG9yXG5cdCAqL1xuXHRmdW5jdGlvbiBoZXhMdW1pbm9jaXR5KGhleCkge1xuXHRcdHZhciByZ2IgPSBoZXhUb1JHQkEoaGV4LCAxKTtcblx0XHRcblx0XHRyZXR1cm4gcmdiTHVtaW5vY2l0eShyZ2IpO1xuXHR9XG5cdFxuXHQvKipcblx0ICogR2VuZXJhdGVzIHRoZSBjb2xvcnMgZm9yIHRoZSBVSVxuXHQgKiBcblx0ICogQHBhcmFtICAge3N0cn0gaGV4IFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSBiYXNlIGNvbG9yXG5cdCAqICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge29ian0gT2JqZWN0IGNvbnRhaW5pbmcgdGhlIGRpZmZlcmVudCBVSSBjb2xvcnNcblx0ICovXG5cdGZ1bmN0aW9uIGdlbmVyYXRlVUlDb2xvcnMoaGV4KSB7XG5cdFx0dmFyIFVJQ29sb3JzICAgICAgICA9IHt9O1xuXHRcdFVJQ29sb3JzLmJhY2tncm91bmQgPSBoZXhPcGFjaXR5KGhleCwgMC4xLCAnI0ZGRkZGRicpO1xuXHRcdFVJQ29sb3JzLmhleCAgICAgICAgPSBoZXhPcGFjaXR5KGhleCwgMC42LCBVSUNvbG9ycy5iYWNrZ3JvdW5kKTtcblx0XHRcblx0XHRpZiAoaGV4THVtaW5vY2l0eShVSUNvbG9ycy5iYWNrZ3JvdW5kKSA+IDAuODUgJiYgaGV4THVtaW5vY2l0eShVSUNvbG9ycy5oZXgpID4gMC44NSkge1xuXHRcdFx0VUlDb2xvcnMuaGV4ID0gaGV4T3BhY2l0eShVSUNvbG9ycy5oZXgsIDAuOSwgJyM0MjQyNDInKTtcblx0XHR9XG5cdFx0XG5cdFx0VUlDb2xvcnMudGV4dHMgPSBoZXhCbGVuZE92ZXJsYXkoaGV4LCAwLjIsICcjNDI0MjQyJyk7XG5cdFx0XG5cdFx0cmV0dXJuIFVJQ29sb3JzO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBleHRlbmQoYSwgYikge1xuXHRcdGZvciAodmFyIGtleSBpbiBiKSB7XG5cdFx0XHRpZiAoYi5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRcdGFba2V5XSA9IGJba2V5XTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIGE7XG5cdH1cblx0XG59KTtcbiJdfQ==
