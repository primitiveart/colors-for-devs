var app=angular.module("colorIpsum",["ngAnimate"]);app.controller("mainController",["$scope","coloripsum","$timeout",function(n,r,e){n.versionColor="#E52B50",n.version="1.7",n.scheme={main:"#000000",complementary:"#000000",dark:"#000000",light:"#000000",noHash:{main:"000000",complementary:"000000",dark:"000000",light:"000000"},luminocity:{main:1,complementary:1,dark:1,light:1},uiColors:{background:"#000000",hex:"#000000",texts:"#000000"}},n.rotate=!1;var t,o,a=function(){var t=null,e=window.location.pathname.split("/"),n=e[e.length-1];if(null!==n.match(/^(([a-fA-F0-9]){6})-(([a-fA-F0-9]){6})-(([a-fA-F0-9]){6})-(([a-fA-F0-9]){6})$/gi)){var r=n.split("-");t={main:"#"+r[0],complementary:"#"+r[1],dark:"#"+r[2],light:"#"+r[3],noHash:{main:r[0],complementary:r[1],dark:r[2],light:r[3]}}}return t}();n.scheme=null!==a?(t=a,s(o=r.generatePaletteFromURL(t),"Colors for devs"),o):c(),n.onKeyUp=function(t){32==t.keyCode&&(n.scheme=c())},n.generateRandom=function(t){n.rotate=!0,e(function(){n.rotate=!1},700),n.scheme=c()},n.generatePalette=function(t){return e=t,s(n=r.palette(e),"Colors for devs"),n;var e,n},n.buildInfo=function(){var t,e={mainHex:n.versionColor};n.versionScheme=(t=e,r.palette(t)),$("body").css("overflow","hidden"),$(".about").fadeIn(200),$(".about-container").show("drop",{direction:"down"},200,function(){$("body").css("overflow","auto")})},n.closeAbout=function(t){"panel about"===t.target.className&&($(".about").css("cursor","auto"),$("body").css("overflow","hidden"),$(".about").fadeOut(200),$(".about-container").hide("drop",{direction:"down"},200,function(){$("body").css("overflow","auto")}))},n.changeCursor=function(t){"panel about"===t.target.className?$(".about").css("cursor","url(assets/images/close.gif), crosshair"):$(".about").css("cursor","auto")},n.selectHexString=function(t){var e,n,r=t.currentTarget.className,o=document.getElementsByClassName(r)[0];window.getSelection?(n=window.getSelection(),(e=document.createRange()).selectNodeContents(o),n.removeAllRanges(),n.addRange(e)):document.body.createTextRange&&((e=document.body.createTextRange()).moveToElementText(o),e.select())};var i=new Clipboard(".color");function c(){var t=r.random();return s(t,"Colors for devs"),t}function s(t,e){var n=window.location.pathname.split("/"),r="/"+n[n.length-1],o="/"+t.noHash.main+"-"+t.noHash.complementary+"-"+t.noHash.dark+"-"+t.noHash.light;o===r?history.replaceState({scheme:t},e):history.pushState({scheme:t},e,o)}i.on("success",function(t){var e=$(t.trigger).attr("class").replace(" color","");$("."+e+".hex .hint")[0]||$("."+e+".hex").append('<span class="hint">copied to clipboard</span>').show(function(){$(".hint").fadeOut(1e3,function(){$(this).remove()})})}),i.on("error",function(t){var e=$(t.trigger).attr("class").replace(" color","");$("."+e+".hex .hint")[0]||$("."+e+".hex").append('<span class="hint">ctrl+c to copy</span>').show(function(){$(".hint").fadeOut(1e3,function(){$(this).remove()})})}),window.onpopstate=function(t){null!==t.state&&n.$apply(function(){n.scheme=t.state.scheme})}}]),app.directive("spectrum",function(){return{restrict:"A",link:function(r,e,t){$(e).spectrum(r.$eval(t.spectrum)),$(e).on("reflow.spectrum",function(t){var e,n,r,o,a,i,c,s;e=$(".sp-container"),n=$(".sp-replacer"),r=e.outerWidth(),o=e.outerHeight(),a=n.outerHeight(),i=e[0].ownerDocument,c=i.documentElement.clientWidth+$(i).scrollLeft(),(s=n.offset()).left+=84,s.top+=a,s.left=s.left+r>c&&r<c?Math.abs(s.left-r):s.left,s.top=Math.abs(s.top-42-o/2),e.css({left:s.left,top:s.top})}),$(e).on("change.spectrum",function(t,e){var n={mainHex:e.toHexString()};r.$apply(function(){r.scheme=r.generatePalette(n)})}),r.$watch("scheme",function(t){$(e).spectrum("set",t.main),$(".sp-preview").css({color:t.uiColors.texts}),$(".sp-preview").css({background:t.main})})}}}),app.directive("setFocus",function(){return{restrict:"A",link:function(t,e,n){e[0].focus()}}}),app.service("coloripsum",function(){var r=this,o=function(){return{main:"",complementary:"",dark:"",light:"",noHash:{main:"",complementary:"",dark:"",light:""},luminocity:{main:"",complementary:"",dark:"",light:""},uiColors:{background:"",hex:"",texts:""}}};function a(t,e){var n,r,o,a,i,c,s="";return u(t)<=.5?(a=t,i=e,(c={}).r=Math.round(2*a.r*i.r/255),c.g=Math.round(2*a.g*i.g/255),c.b=Math.round(2*a.b*i.b/255),c.a=i.a,s=l(c,a)):(n=t,r=e,(o={}).r=Math.round(255*(1-(1-n.r/255)*(1-(2*r.r/255-1)))),o.g=Math.round(255*(1-(1-n.g/255)*(1-(2*r.g/255-1)))),o.b=Math.round(255*(1-(1-n.b/255)*(1-(2*r.b/255-1)))),o.a=r.a,s=l(o,n)),s}function u(t){return(t.r+t.g+t.b)/3/255}function l(t,e){var n,r,o,a={};return a.r=(1-t.a)*e.r+t.a*t.r,a.g=(1-t.a)*e.g+t.a*t.g,a.b=(1-t.a)*e.b+t.a*t.b,n=a.r,r=a.g,o=a.b,"#"+s(n)+s(r)+s(o)}function i(t,e){var n,r,o;return{r:(o=t,parseInt(c(o).substring(0,2),16)),g:(r=t,parseInt(c(r).substring(2,4),16)),b:(n=t,parseInt(c(n).substring(4,6),16)),a:e}}function c(t){return"#"==t.charAt(0)?t.substring(1,7):t}function s(t){return t=parseInt(t,10),isNaN(t)?"00":(t=Math.max(0,Math.min(t,255)),"0123456789ABCDEF".charAt((t-t%16)/16)+"0123456789ABCDEF".charAt(t%16))}function m(t){var e=Math.random(),n="#EEEEEE";t&&(n="#777777",e=-e);var r=parseInt(n.slice(1),16),o=e<0?0:255,a=e<0?-1*e:e,i=r>>16,c=r>>8&255,s=255&r;return"#"+(16777216+65536*(Math.round((o-i)*a)+i)+256*(Math.round((o-c)*a)+c)+(Math.round((o-s)*a)+s)).toString(16).slice(1)}function h(t,e,n){return l(i(t,e),i(n,1))}function p(t,e,n){var r=i(t,e);return a(i(n,1),r)}function d(t){return u(i(t,1))}function f(t){var e={};return e.background=h(t,.1,"#FFFFFF"),e.hex=h(t,.6,e.background),.85<d(e.background)&&.85<d(e.hex)&&(e.hex=h(e.hex,.9,"#424242")),e.texts=p(t,.2,"#424242"),e}function g(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}this.random=function(){var t=function(){var t="";for(;t.length<6;)t+=Math.random().toString(16).substr(-6).substr(-1);return"#"+t}(),e=m(!0),n=m(!1);return r.palette({mainHex:t,darkHex:e,lightHex:n})},this.palette=function(t){var e=g({mainHex:"#FFFFFF",darkHex:"#424242",lightHex:"#FAFAFA"},t),n=new o;return n.main=e.mainHex,n.noHash.main=c(n.main).toUpperCase(),n.luminocity.main=d(n.main),n.complementary=function(t){var e=(0+(16777215-(n=t,t=parseInt(n.replace(/^#/,""),16))).toString(16)).slice(-6);var n;for(;e.length<6;)e="0"+e;return"#"+e}(e.mainHex),n.noHash.complementary=c(n.complementary).toUpperCase(),n.luminocity.complementary=d(n.complementary),n.dark=p(e.mainHex,.2,e.darkHex),n.noHash.dark=c(n.dark).toUpperCase(),n.luminocity.dark=d(n.dark),n.light=p(e.mainHex,.2,e.lightHex),n.noHash.light=c(n.light).toUpperCase(),n.luminocity.light=d(n.light),n.uiColors=g(n.uiColors,f(n.main)),n},this.generatePaletteFromURL=function(t){var e=g(new o,t);return e.luminocity.main=d(e.main),e.luminocity.complementary=d(e.complementary),e.luminocity.dark=d(e.dark),e.luminocity.light=d(e.light),e.uiColors=g(e.uiColors,f(e.main)),e},this.hexToRGBA=function(t,e){return i(t,e)},this.rgbaToHex=function(t,e){return l(t,e)},this.hexOpacity=function(t,e,n){return h(t,e,n)},this.hexBlendOverlay=function(t,e,n){return p(t,e,n)},this.hexLuminocity=function(t){return d(t)}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbG9yaXBzdW0uanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJjb2xvcmlwc3VtIiwiJHRpbWVvdXQiLCJ2ZXJzaW9uQ29sb3IiLCJ2ZXJzaW9uIiwic2NoZW1lIiwibWFpbiIsImNvbXBsZW1lbnRhcnkiLCJkYXJrIiwibGlnaHQiLCJub0hhc2giLCJsdW1pbm9jaXR5IiwidWlDb2xvcnMiLCJiYWNrZ3JvdW5kIiwiaGV4IiwidGV4dHMiLCJyb3RhdGUiLCJvcHRpb25zIiwicGF0aEFycmF5Iiwid2luZG93IiwibG9jYXRpb24iLCJwYXRobmFtZSIsInNwbGl0IiwiaGV4U3RyaW5nIiwibGVuZ3RoIiwibWF0Y2giLCJjb2xvcnNBcnJheSIsImNoZWNrRm9yVXJsVmFsdWVzIiwiaGlzdG9yeVJlZnJlc2giLCJnZW5lcmF0ZVBhbGV0dGVGcm9tVVJMIiwicmFuZG9tU2NoZW1lIiwib25LZXlVcCIsIiRldmVudCIsImtleUNvZGUiLCJnZW5lcmF0ZVJhbmRvbSIsImdlbmVyYXRlUGFsZXR0ZSIsInBhbGV0dGUiLCJidWlsZEluZm8iLCJtYWluSGV4IiwidmVyc2lvblNjaGVtZSIsIiQiLCJjc3MiLCJmYWRlSW4iLCJzaG93IiwiZGlyZWN0aW9uIiwiY2xvc2VBYm91dCIsInRhcmdldCIsImNsYXNzTmFtZSIsImZhZGVPdXQiLCJoaWRlIiwiY2hhbmdlQ3Vyc29yIiwic2VsZWN0SGV4U3RyaW5nIiwicmFuZ2UiLCJzZWxlY3Rpb24iLCJlbGVtZW50Q2xhc3MiLCJjdXJyZW50VGFyZ2V0IiwiZWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImdldFNlbGVjdGlvbiIsImNyZWF0ZVJhbmdlIiwic2VsZWN0Tm9kZUNvbnRlbnRzIiwicmVtb3ZlQWxsUmFuZ2VzIiwiYWRkUmFuZ2UiLCJib2R5IiwiY3JlYXRlVGV4dFJhbmdlIiwibW92ZVRvRWxlbWVudFRleHQiLCJzZWxlY3QiLCJjbGlwYm9hcmQiLCJDbGlwYm9hcmQiLCJyYW5kb20iLCJ0aXRsZSIsImN1cnJlbnRVUkwiLCJuZXdVUkwiLCJoaXN0b3J5IiwicmVwbGFjZVN0YXRlIiwicHVzaFN0YXRlIiwib24iLCJlIiwiY29sb3IiLCJ0cmlnZ2VyIiwiYXR0ciIsInJlcGxhY2UiLCJhcHBlbmQiLCJ0aGlzIiwicmVtb3ZlIiwib25wb3BzdGF0ZSIsImV2ZW50Iiwic3RhdGUiLCIkYXBwbHkiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsImxpbmsiLCJzY29wZSIsImF0dHJzIiwic3BlY3RydW0iLCIkZXZhbCIsInBpY2tlciIsImlucHV0IiwiZHBXaWR0aCIsImRwSGVpZ2h0IiwiaW5wdXRIZWlnaHQiLCJkb2MiLCJ2aWV3V2lkdGgiLCJvZmZzZXQiLCJvdXRlcldpZHRoIiwib3V0ZXJIZWlnaHQiLCJvd25lckRvY3VtZW50IiwiZG9jdW1lbnRFbGVtZW50IiwiY2xpZW50V2lkdGgiLCJzY3JvbGxMZWZ0IiwibGVmdCIsInRvcCIsIk1hdGgiLCJhYnMiLCJ0aW55Y29sb3IiLCJ0b0hleFN0cmluZyIsIiR3YXRjaCIsImZvY3VzIiwic2VydmljZSIsInNlbGYiLCJwYWxldHRlVGVtcGxhdGUiLCJibGVuZE92ZXJsYXkiLCJiYXNlUkdCIiwiY29sb3JSR0JBIiwiYmxlbmQiLCJyZ2JMdW1pbm9jaXR5IiwiciIsInJvdW5kIiwiZyIsImIiLCJhIiwicmdiYVRvSGV4IiwicmdiIiwicmdiYSIsIlIiLCJHIiwiQiIsInRvSGV4IiwiaGV4VG9SR0JBIiwiYWxwaGEiLCJwYXJzZUludCIsImN1dEhleCIsInN1YnN0cmluZyIsImNoYXJBdCIsIm4iLCJpc05hTiIsIm1heCIsIm1pbiIsInJhbmRvbVNoYWRlcyIsInBlcmNlbnQiLCJmIiwic2xpY2UiLCJ0IiwicCIsInRvU3RyaW5nIiwiaGV4T3BhY2l0eSIsImJhc2VIZXgiLCJoZXhCbGVuZE92ZXJsYXkiLCJoZXhMdW1pbm9jaXR5IiwiZ2VuZXJhdGVVSUNvbG9ycyIsIlVJQ29sb3JzIiwiZXh0ZW5kIiwia2V5IiwiaGFzT3duUHJvcGVydHkiLCJzdWJzdHIiLCJyYW5kb21IZXgiLCJkYXJrSGV4IiwibGlnaHRIZXgiLCJvcHRzIiwidG9VcHBlckNhc2UiLCJmaW5kQ29tcGxlbWVudGFyeSJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBQUEsSUFBQUMsUUFBQUMsT0FBQSxhQUFBLENBQUEsY0FFQUYsSUFBQUcsV0FBQSxpQkFBQSxDQUFBLFNBQUEsYUFBQSxXQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBRUFGLEVBQUFHLGFBQUEsVUFDQUgsRUFBQUksUUFBQSxNQUVBSixFQUFBSyxPQUFBLENBQ0FDLEtBQUEsVUFDQUMsY0FBQSxVQUNBQyxLQUFBLFVBQ0FDLE1BQUEsVUFDQUMsT0FBQSxDQUNBSixLQUFBLFNBQ0FDLGNBQUEsU0FDQUMsS0FBQSxTQUNBQyxNQUFBLFVBRUFFLFdBQUEsQ0FDQUwsS0FBQSxFQUNBQyxjQUFBLEVBQ0FDLEtBQUEsRUFDQUMsTUFBQSxHQUVBRyxTQUFBLENBQ0FDLFdBQUEsVUFDQUMsSUFBQSxVQUNBQyxNQUFBLFlBSUFmLEVBQUFnQixRQUFBLEVBRUEsSUF3S0FDLEVBQ0FaLEVBektBQSxFQXVJQSxXQUNBLElBQUFBLEVBQUEsS0FFQWEsRUFEQUMsT0FBQUMsU0FBQUMsU0FDQUMsTUFBQSxLQUNBQyxFQUFBTCxFQUFBQSxFQUFBTSxPQUFBLEdBRUEsR0FBQSxPQUFBRCxFQUFBRSxNQUFBLG1GQUFBLENBQ0EsSUFBQUMsRUFBQUgsRUFBQUQsTUFBQSxLQUVBakIsRUFBQSxDQUNBQyxLQUFBLElBQUFvQixFQUFBLEdBQ0FuQixjQUFBLElBQUFtQixFQUFBLEdBQ0FsQixLQUFBLElBQUFrQixFQUFBLEdBQ0FqQixNQUFBLElBQUFpQixFQUFBLEdBQ0FoQixPQUFBLENBQ0FKLEtBQUFvQixFQUFBLEdBQ0FuQixjQUFBbUIsRUFBQSxHQUNBbEIsS0FBQWtCLEVBQUEsR0FDQWpCLE1BQUFpQixFQUFBLEtBS0EsT0FBQXJCLEVBOUpBc0IsR0FJ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S0FBQXZELHVCQUFBLFNBQUFaLEdBQ0EsSUFBQW1CLEVBQUE4SCxFQUFBLElBQUF6QyxFQUFBeEcsR0FTQSxPQVBBbUIsRUFBQXpCLFdBQUFMLEtBQUF5SixFQUFBM0gsRUFBQTlCLE1BQ0E4QixFQUFBekIsV0FBQUosY0FBQXdKLEVBQUEzSCxFQUFBN0IsZUFDQTZCLEVBQUF6QixXQUFBSCxLQUFBdUosRUFBQTNILEVBQUE1QixNQUNBNEIsRUFBQXpCLFdBQUFGLE1BQUFzSixFQUFBM0gsRUFBQTNCLE9BRUEyQixFQUFBeEIsU0FBQXNKLEVBQUE5SCxFQUFBeEIsU0FBQW9KLEVBQUE1SCxFQUFBOUIsT0FFQThCLEdBR0FnRCxLQUFBdUQsVUFBQSxTQUFBN0gsRUFBQThILEdBQ0EsT0FBQUQsRUFBQTdILEVBQUE4SCxJQUdBeEQsS0FBQWdELFVBQUEsU0FBQUUsRUFBQVgsR0FDQSxPQUFBUyxFQUFBRSxFQUFBWCxJQUdBdkMsS0FBQXdFLFdBQUEsU0FBQTlJLEVBQUE4SCxFQUFBaUIsR0FDQSxPQUFBRCxFQUFBOUksRUFBQThILEVBQUFpQixJQUdBekUsS0FBQTBFLGdCQUFBLFNBQUFoSixFQUFBOEgsRUFBQWlCLEdBQ0EsT0FBQUMsRUFBQWhKLEVBQUE4SCxFQUFBaUIsSUFHQXpFLEtBQUEyRSxjQUFBLFNBQUFqSixHQUNBLE9BQUFpSixFQUFBakoiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdjb2xvcklwc3VtJyxbJ25nQW5pbWF0ZSddKTtcblxuYXBwLmNvbnRyb2xsZXIoJ21haW5Db250cm9sbGVyJywgWyckc2NvcGUnLCAnY29sb3JpcHN1bScsICckdGltZW91dCcsIGZ1bmN0aW9uKCRzY29wZSwgY29sb3JpcHN1bSwgJHRpbWVvdXQpIHtcblx0XG5cdCRzY29wZS52ZXJzaW9uQ29sb3IgPSAnI0U1MkI1MCc7XG5cdCRzY29wZS52ZXJzaW9uICAgICAgPSAnMS43Jztcblx0XG5cdCRzY29wZS5zY2hlbWUgPSB7XG5cdFx0bWFpbiA6ICcjMDAwMDAwJyxcblx0XHRjb21wbGVtZW50YXJ5IDogJyMwMDAwMDAnLFxuXHRcdGRhcmsgOiAnIzAwMDAwMCcsXG5cdFx0bGlnaHQgOiAnIzAwMDAwMCcsXG5cdFx0bm9IYXNoIDoge1xuXHRcdFx0bWFpbiA6ICcwMDAwMDAnLFxuXHRcdFx0Y29tcGxlbWVudGFyeSA6ICcwMDAwMDAnLFxuXHRcdFx0ZGFyayA6ICcwMDAwMDAnLFxuXHRcdFx0bGlnaHQgOiAnMDAwMDAwJ1xuXHRcdH0sXG5cdFx0bHVtaW5vY2l0eSA6IHtcblx0XHRcdG1haW4gOiAxLFxuXHRcdFx0Y29tcGxlbWVudGFyeSA6IDEsXG5cdFx0XHRkYXJrIDogMSxcblx0XHRcdGxpZ2h0IDogMVxuXHRcdH0sXG5cdFx0dWlDb2xvcnMgOiB7XG5cdFx0XHRiYWNrZ3JvdW5kIDogJyMwMDAwMDAnLFxuXHRcdFx0aGV4IDogJyMwMDAwMDAnLFxuXHRcdFx0dGV4dHMgOiAnIzAwMDAwMCdcblx0XHR9XG5cdH07XG5cdFxuXHQkc2NvcGUucm90YXRlID0gZmFsc2U7XG5cdFxuXHR2YXIgc2NoZW1lID0gY2hlY2tGb3JVcmxWYWx1ZXMoKTtcblx0XG5cdC8vIENoZWNrIGlmIGNvbG9yIHBhbGV0dGUgaXMgZ2l2ZW4gdGhyb3VnaCBVUkwgdmFsdWVzXG5cdGlmIChzY2hlbWUgIT09IG51bGwpIHtcblx0XHQkc2NvcGUuc2NoZW1lID0gZ2VuZXJhdGVQYWxldHRlRnJvbVVSTChzY2hlbWUpO1xuXHR9IGVsc2Uge1xuXHRcdCRzY29wZS5zY2hlbWUgPSByYW5kb21TY2hlbWUoKTtcblx0fVx0XG5cdFxuXHQkc2NvcGUub25LZXlVcCA9IGZ1bmN0aW9uKCRldmVudCkge1xuXHRcdGlmICgkZXZlbnQua2V5Q29kZSA9PSAzMikge1xuXHRcdFx0JHNjb3BlLnNjaGVtZSA9IHJhbmRvbVNjaGVtZSgpO1xuXHRcdH1cblx0fTtcblx0XG5cdCRzY29wZS5nZW5lcmF0ZVJhbmRvbSA9IGZ1bmN0aW9uKCRldmVudCApIHtcblx0XHQkc2NvcGUucm90YXRlID0gdHJ1ZTtcblx0XHRcblx0XHQkdGltZW91dChmdW5jdGlvbigpeyBcblx0XHRcdCRzY29wZS5yb3RhdGUgPSBmYWxzZTtcblx0XHR9LCA3MDApO1xuXHRcdFxuXHRcdFxuXHRcdCRzY29wZS5zY2hlbWUgPSByYW5kb21TY2hlbWUoKTtcblx0fTtcblx0XG5cdC8vTmVlZCBwYWxldHRlIGZ1bmN0aW9uIHRvIGJlIGFjY2Vzc2libGUgZnJvbSBzY29wZSB0byB1c2UgaXQgaW4gc3BlY3RydW0gZGlyZWN0aXZlXG5cdCRzY29wZS5nZW5lcmF0ZVBhbGV0dGUgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0cmV0dXJuIHBhbGV0dGUob3B0aW9ucyk7XG5cdH07XG5cdFxuXHQkc2NvcGUuYnVpbGRJbmZvID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG9wdGlvbnMgPSB7XG5cdFx0XHRtYWluSGV4IDogJHNjb3BlLnZlcnNpb25Db2xvclxuXHRcdH07XG4gICAgICAgIFxuXHRcdCRzY29wZS52ZXJzaW9uU2NoZW1lID0gdmVyc2lvblBhbGV0dGUob3B0aW9ucyk7XG4gICAgICAgIFxuXHRcdCQoJ2JvZHknKS5jc3MoJ292ZXJmbG93JywnaGlkZGVuJyk7XG4gICAgICAgIFxuXHRcdCQoJy5hYm91dCcpLmZhZGVJbigyMDApO1xuICAgICAgICBcblx0XHQkKCcuYWJvdXQtY29udGFpbmVyJykuc2hvdygnZHJvcCcsIHsgZGlyZWN0aW9uOidkb3duJyB9LCAyMDAsIGZ1bmN0aW9uKCkge1xuXHRcdFx0JCgnYm9keScpLmNzcygnb3ZlcmZsb3cnLCdhdXRvJyk7XG5cdFx0fSk7XG5cdH07XG5cdFxuXHQkc2NvcGUuY2xvc2VBYm91dCA9IGZ1bmN0aW9uKCRldmVudCkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gJGV2ZW50LnRhcmdldC5jbGFzc05hbWU7XG4gICAgICAgIFxuICAgICAgICBpZiAodGFyZ2V0ID09PSBcInBhbmVsIGFib3V0XCIpIHtcbiAgICAgICAgICAgICQoJy5hYm91dCcpLmNzcygnY3Vyc29yJywgJ2F1dG8nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJCgnYm9keScpLmNzcygnb3ZlcmZsb3cnLCdoaWRkZW4nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJCgnLmFib3V0JykuZmFkZU91dCgyMDApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKCcuYWJvdXQtY29udGFpbmVyJykuaGlkZSgnZHJvcCcsIHsgZGlyZWN0aW9uOidkb3duJyB9LCAyMDAsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmNzcygnb3ZlcmZsb3cnLCdhdXRvJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXHR9O1xuICAgIFxuICAgICRzY29wZS5jaGFuZ2VDdXJzb3IgPSBmdW5jdGlvbigkZXZlbnQpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9ICRldmVudC50YXJnZXQuY2xhc3NOYW1lO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRhcmdldCA9PT0gXCJwYW5lbCBhYm91dFwiKSB7XG4gICAgICAgICAgICAkKCcuYWJvdXQnKS5jc3MoJ2N1cnNvcicsICd1cmwoYXNzZXRzL2ltYWdlcy9jbG9zZS5naWYpLCBjcm9zc2hhaXInKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQoJy5hYm91dCcpLmNzcygnY3Vyc29yJywgJ2F1dG8nKTtcbiAgICAgICAgfVxuXHR9O1xuXHRcblx0JHNjb3BlLnNlbGVjdEhleFN0cmluZyA9IGZ1bmN0aW9uKCRldmVudCkge1xuXHRcdHZhciByYW5nZSwgc2VsZWN0aW9uO1xuXHRcdHZhciBlbGVtZW50Q2xhc3MgPSAkZXZlbnQuY3VycmVudFRhcmdldC5jbGFzc05hbWU7XG5cdFx0dmFyIGVsZW1lbnQgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoZWxlbWVudENsYXNzKVswXTtcblxuXHRcdGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKSB7XG5cdFx0XHRzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7XG5cdFx0XHRyYW5nZSAgICAgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xuICAgICAgICAgICAgXG5cdFx0XHRyYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoZWxlbWVudCk7XG5cdFx0XHRzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7XG5cdFx0XHRzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xuXHRcdH0gZWxzZSBpZiAoZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UpIHtcblx0XHRcdHJhbmdlID0gZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKTtcbiAgICAgICAgICAgIFxuXHRcdFx0cmFuZ2UubW92ZVRvRWxlbWVudFRleHQoZWxlbWVudCk7XG5cdFx0XHRyYW5nZS5zZWxlY3QoKTtcblx0XHR9XHRcblx0fTtcblx0XG5cdC8vQ29weSB0byBjbGlwYm9hcmQgcGx1Z2luXG5cdHZhciBjbGlwYm9hcmQgPSBuZXcgQ2xpcGJvYXJkKCcuY29sb3InKTtcblx0XG5cdGNsaXBib2FyZC5vbignc3VjY2VzcycsIGZ1bmN0aW9uKGUpIHtcblx0XHR2YXIgJGVsZW1lbnQgPSAkKGUudHJpZ2dlcik7XG5cdFx0dmFyIGNvbG9yICAgID0gJGVsZW1lbnQuYXR0cignY2xhc3MnKS5yZXBsYWNlKCcgY29sb3InLCcnKTtcblxuXHRcdGlmICghJCgnLicgKyBjb2xvciArICcuaGV4IC5oaW50JylbMF0pIHtcblx0XHRcdCQoJy4nICsgY29sb3IgKyAnLmhleCcpLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJoaW50XCI+Y29waWVkIHRvIGNsaXBib2FyZDwvc3Bhbj4nKS5zaG93KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKCcuaGludCcpLmZhZGVPdXQoMTAwMCwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0JCh0aGlzKS5yZW1vdmUoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH0pO1xuXG5cdGNsaXBib2FyZC5vbignZXJyb3InLCBmdW5jdGlvbihlKSB7XG5cdFx0dmFyICRlbGVtZW50ID0gJChlLnRyaWdnZXIpO1xuXHRcdHZhciBjb2xvciAgICA9ICRlbGVtZW50LmF0dHIoJ2NsYXNzJykucmVwbGFjZSgnIGNvbG9yJywnJyk7XG5cdFx0XG5cdFx0aWYgKCEkKCcuJyArIGNvbG9yICsgJy5oZXggLmhpbnQnKVswXSkge1xuXHRcdFx0JCgnLicgKyBjb2xvciArICcuaGV4JykuYXBwZW5kKCc8c3BhbiBjbGFzcz1cImhpbnRcIj5jdHJsK2MgdG8gY29weTwvc3Bhbj4nKS5zaG93KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKCcuaGludCcpLmZhZGVPdXQoMTAwMCwgZnVuY3Rpb24oKXtcblx0XHRcdFx0XHQkKHRoaXMpLnJlbW92ZSgpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSk7XG5cdFxuXHR3aW5kb3cub25wb3BzdGF0ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0aWYgKGV2ZW50LnN0YXRlICE9PSBudWxsKSB7XG5cdFx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkc2NvcGUuc2NoZW1lID0gZXZlbnQuc3RhdGUuc2NoZW1lO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xuXHRcblx0LyoqXG5cdCAqIENoZWNrcyBVUkwgZm9yIGhleCBjb2Rlc1xuXHQgKiBcblx0ICogQHJldHVybnMge29ian0gVGhlIHNjaGVtZSBvYmplY3QgYmFzZWQgb24gdGhlIFVSTCBcblx0ICovXG5cdGZ1bmN0aW9uIGNoZWNrRm9yVXJsVmFsdWVzKCkge1xuXHRcdHZhciBzY2hlbWUgICAgICA9IG51bGw7XG5cdFx0dmFyIGN1cnJlbnRQYXRoID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lO1xuXHRcdHZhciBwYXRoQXJyYXkgICA9IGN1cnJlbnRQYXRoLnNwbGl0KCcvJyk7XG5cdFx0dmFyIGhleFN0cmluZyAgID0gcGF0aEFycmF5W3BhdGhBcnJheS5sZW5ndGggLSAxXTtcbiAgICAgICAgXG5cdFx0aWYgKGhleFN0cmluZy5tYXRjaCgvXigoW2EtZkEtRjAtOV0pezZ9KS0oKFthLWZBLUYwLTldKXs2fSktKChbYS1mQS1GMC05XSl7Nn0pLSgoW2EtZkEtRjAtOV0pezZ9KSQvaWcpICE9PSBudWxsKSB7XG5cdFx0XHR2YXIgY29sb3JzQXJyYXkgPSBoZXhTdHJpbmcuc3BsaXQoJy0nKTtcbiAgICAgICAgICAgIFxuXHRcdFx0c2NoZW1lID0ge1xuXHRcdFx0XHRtYWluIDogJyMnICsgY29sb3JzQXJyYXlbMF0sXG5cdFx0XHRcdGNvbXBsZW1lbnRhcnkgOiAnIycgKyBjb2xvcnNBcnJheVsxXSxcblx0XHRcdFx0ZGFyayA6ICcjJyArIGNvbG9yc0FycmF5WzJdLFxuXHRcdFx0XHRsaWdodCA6ICcjJyArIGNvbG9yc0FycmF5WzNdLFxuXHRcdFx0XHRub0hhc2ggOiB7XG5cdFx0XHRcdFx0bWFpbiA6IGNvbG9yc0FycmF5WzBdLFxuXHRcdFx0XHRcdGNvbXBsZW1lbnRhcnkgOiBjb2xvcnNBcnJheVsxXSxcblx0XHRcdFx0XHRkYXJrIDogY29sb3JzQXJyYXlbMl0sXG5cdFx0XHRcdFx0bGlnaHQgOiBjb2xvcnNBcnJheVszXVxuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gc2NoZW1lO1xuXHR9XG5cdFxuXHQvKipcblx0ICogR2VuZXJhdGVzIGNvbG9yIHBhbGV0dGUgYmFzZWQgb24gc2NoZW1lIG9iamVjdCBnZW5lcmF0ZWQgYnkgVVJMXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7b2JqfSBvcHRpb25zIFRoZSBzY2hlbWUgb2JqZWN0IGdlbmVyYXRlZCBieSBVUkxcblx0ICogICAgICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge29ian0gVGhlIGNvbXBsZXRlIHNjaGVtZSBvYmplY3Rcblx0ICovXG5cdGZ1bmN0aW9uIGdlbmVyYXRlUGFsZXR0ZUZyb21VUkwob3B0aW9ucykge1xuXHRcdHZhciBzY2hlbWUgPSBjb2xvcmlwc3VtLmdlbmVyYXRlUGFsZXR0ZUZyb21VUkwob3B0aW9ucyk7XG5cdFx0XG5cdFx0aGlzdG9yeVJlZnJlc2goc2NoZW1lLCAnQ29sb3JzIGZvciBkZXZzJyk7XG5cdFx0XG5cdFx0cmV0dXJuIHNjaGVtZTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhIHJhbmRvbSBjb2xvciBzY2hlbWVcblx0ICogXG5cdCAqIEByZXR1cm5zIHtvYmp9IEEgY29tcGxldGUgc2NoZW1lIG9iamVjdFxuXHQgKi9cblx0ZnVuY3Rpb24gcmFuZG9tU2NoZW1lKCkge1xuXHRcdHZhciBzY2hlbWUgPSBjb2xvcmlwc3VtLnJhbmRvbSgpO1xuXHRcdFxuXHRcdGhpc3RvcnlSZWZyZXNoKHNjaGVtZSwgJ0NvbG9ycyBmb3IgZGV2cycpO1xuXHRcdFxuXHRcdHJldHVybiBzY2hlbWU7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYSBjb2xvciBwYWxldHRlIGJhc2VkIG9uIGJhc2UgY29sb3JzXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7b2JqfSBvcHRpb25zIHttYWluSGV4LCBkYXJrSGV4LCBsaWdodEhleH1cblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7b2JqfSBBIGNvbXBsZXRlIHNjaGVtZSBvYmplY3Rcblx0ICovXG5cdGZ1bmN0aW9uIHBhbGV0dGUob3B0aW9ucykge1xuXHRcdHZhciBzY2hlbWUgPSBjb2xvcmlwc3VtLnBhbGV0dGUob3B0aW9ucyk7XG5cdFx0XG5cdFx0aGlzdG9yeVJlZnJlc2goc2NoZW1lLCAnQ29sb3JzIGZvciBkZXZzJyk7XG5cdFx0XG5cdFx0cmV0dXJuIHNjaGVtZTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEdlbmVyYXRlcyB0aGUgY3VycmVudCB2ZXJzaW9uIHBhbGV0dGVcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtvYmp9IG9wdGlvbnMge21haW5IZXgsIGRhcmtIZXgsIGxpZ2h0SGV4fVxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7b2JqfSBBIGNvbXBsZXRlIHNjaGVtZSBvYmplY3Rcblx0ICovXG5cdGZ1bmN0aW9uIHZlcnNpb25QYWxldHRlKG9wdGlvbnMpIHtcblx0XHR2YXIgc2NoZW1lID0gY29sb3JpcHN1bS5wYWxldHRlKG9wdGlvbnMpO1xuXHRcdFxuXHRcdHJldHVybiBzY2hlbWU7XG5cdH1cblx0XG5cdC8qKlxuICAgICogTWFuYWdlIEhUTUw1IGhpc3RvcnkgdXJsIGNoYW5nZSAocHVzaCBvciByZXBsYWNlKVxuICAgICpcblx0KiBAcGFyYW0ge29ian0gc2NoZW1lIFRoZSBjdXJyZW50IHNjaGVtZVxuXHQqIEBwYXJhbSB7c3RyfSB0aXRsZSAgVGhlIHBhZ2UgdGl0bGVcbiAgICAqL1xuXHRmdW5jdGlvbiBoaXN0b3J5UmVmcmVzaChzY2hlbWUsIHRpdGxlKSB7XG5cdFx0dmFyIGN1cnJlbnRQYXRoID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lO1xuXHRcdHZhciBwYXRoQXJyYXkgICA9IGN1cnJlbnRQYXRoLnNwbGl0KCcvJyk7XG5cdFx0dmFyIGN1cnJlbnRVUkwgID0gJy8nK3BhdGhBcnJheVtwYXRoQXJyYXkubGVuZ3RoIC0gMV07XG5cdFx0dmFyIG5ld1VSTCAgICAgID0gJy8nK3NjaGVtZS5ub0hhc2gubWFpbisnLScrc2NoZW1lLm5vSGFzaC5jb21wbGVtZW50YXJ5KyctJytzY2hlbWUubm9IYXNoLmRhcmsrJy0nK3NjaGVtZS5ub0hhc2gubGlnaHQrJyc7XG5cdFx0XG5cdFx0aWYgKG5ld1VSTCA9PT0gY3VycmVudFVSTCkge1xuXHRcdFx0aGlzdG9yeS5yZXBsYWNlU3RhdGUoe3NjaGVtZTogc2NoZW1lfSwgdGl0bGUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRoaXN0b3J5LnB1c2hTdGF0ZSh7c2NoZW1lOiBzY2hlbWV9LCB0aXRsZSwgbmV3VVJMKTtcblx0XHR9XG5cdH1cbn1dKTtcblxuXG4vKipcbiogRGlyZWN0aXZlIGZvciBzcGVjdHJ1bSBqUXVlcnkgcGx1Z2luXG4qXG4qL1xuYXBwLmRpcmVjdGl2ZSgnc3BlY3RydW0nLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblxuICAgICAgICAgICAgJChlbGVtZW50KS5zcGVjdHJ1bShzY29wZS4kZXZhbChhdHRycy5zcGVjdHJ1bSkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBPdmVycmlkZSBzcGVjdHJ1bSBuYXRpdmUgcG9zaXRpb25pbmdcbiAgICAgICAgICAgICQoZWxlbWVudCkub24oJ3JlZmxvdy5zcGVjdHJ1bScsIGZ1bmN0aW9uKGUpIHsgXG4gICAgICAgICAgICAgICAgc2V0UGlja2VyUG9zaXRpb24oJCgnLnNwLWNvbnRhaW5lcicpLCAkKCcuc3AtcmVwbGFjZXInKSk7XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuXHRcdFx0JChlbGVtZW50KS5vbignY2hhbmdlLnNwZWN0cnVtJywgZnVuY3Rpb24oZSwgdGlueWNvbG9yKSB7IFxuXHRcdFx0XHR2YXIgb3B0aW9ucyA9IHtcblx0XHRcdFx0XHRtYWluSGV4IDogdGlueWNvbG9yLnRvSGV4U3RyaW5nKClcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0c2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHNjb3BlLnNjaGVtZSA9IHNjb3BlLmdlbmVyYXRlUGFsZXR0ZShvcHRpb25zKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuXHRcdFx0c2NvcGUuJHdhdGNoKCdzY2hlbWUnLCBmdW5jdGlvbihjb2xvcikge1xuXHRcdFx0XHQkKGVsZW1lbnQpLnNwZWN0cnVtKFwic2V0XCIsIGNvbG9yLm1haW4pO1xuXHRcdFx0XHRcblx0XHRcdFx0JCgnLnNwLXByZXZpZXcnKS5jc3Moe1xuXHRcdFx0XHRcdCdjb2xvcicgOiBjb2xvci51aUNvbG9ycy50ZXh0c1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdCQoJy5zcC1wcmV2aWV3JykuY3NzKHtcblx0XHRcdFx0XHQnYmFja2dyb3VuZCcgOiBjb2xvci5tYWluXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU2V0IHRoZSBwb3NpdGlvbiBvZiB0aGUgY29sb3IgcGlja2VyIChvdmVycmlkZSBzcGVjdHJ1bSBuYXRpdmUgcG9zaXRpb25pbmcpXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIEBwYXJhbSB7b2JqfSBwaWNrZXIgalF1ZXJ5IG9iamVjdDogVGhlIGNvbG9yIHBpY2tlciBjb250YWluZXJcbiAgICAgICAgICAgICAqIEBwYXJhbSB7b2JqfSBpbnB1dCAgalF1ZXJ5IG9iamVjdDogVGhlIGNvbG9yIHBpY2tlciBpbnB1dCByZXBsYWNlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmdW5jdGlvbiBzZXRQaWNrZXJQb3NpdGlvbihwaWNrZXIsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRwV2lkdGggICAgID0gcGlja2VyLm91dGVyV2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgZHBIZWlnaHQgICAgPSBwaWNrZXIub3V0ZXJIZWlnaHQoKTtcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXRIZWlnaHQgPSBpbnB1dC5vdXRlckhlaWdodCgpO1xuICAgICAgICAgICAgICAgIHZhciBkb2MgICAgICAgICA9IHBpY2tlclswXS5vd25lckRvY3VtZW50O1xuICAgICAgICAgICAgICAgIHZhciBkb2NFbGVtICAgICA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgdmFyIHZpZXdXaWR0aCAgID0gZG9jRWxlbS5jbGllbnRXaWR0aCArICQoZG9jKS5zY3JvbGxMZWZ0KCk7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCAgICAgID0gaW5wdXQub2Zmc2V0KCk7XG4gICAgICAgICAgICAgICAgb2Zmc2V0LmxlZnQgICAgKz0gODQ7XG4gICAgICAgICAgICAgICAgb2Zmc2V0LnRvcCAgICAgKz0gaW5wdXRIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICBvZmZzZXQubGVmdCAgICAgPSAob2Zmc2V0LmxlZnQgKyBkcFdpZHRoID4gdmlld1dpZHRoICYmIHZpZXdXaWR0aCA+IGRwV2lkdGgpID8gTWF0aC5hYnMob2Zmc2V0LmxlZnQgLSBkcFdpZHRoKSA6IG9mZnNldC5sZWZ0O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIG9mZnNldC50b3AgICAgICA9IE1hdGguYWJzKG9mZnNldC50b3AgLSA0MiAtIChkcEhlaWdodCAvIDIpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBwaWNrZXIuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogb2Zmc2V0LmxlZnQsXG4gICAgICAgICAgICAgICAgICAgIHRvcDogb2Zmc2V0LnRvcFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn0pO1xuXG4vKipcbiogRGlyZWN0aXZlIHRvIGZvY3VzIG9uIGFuIGVsZW1lbnRcbipcbiogQ2FuJ3QgZ2l2ZSBpc29sYXRlZCBzY29wZSBiZWNhdXNlIGl0IHdpbGwgcmVzdWx0IGluICRjb21waWxlOm11bHRpZGlyIGVycm9yXG4qL1xuYXBwLmRpcmVjdGl2ZSgnc2V0Rm9jdXMnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIGVsZW1lbnRbMF0uZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH07XG59KTsiLCJhcHAuc2VydmljZSgnY29sb3JpcHN1bScsIGZ1bmN0aW9uKCkge1xuICAgIFxuXHR2YXIgc2VsZiA9IHRoaXM7XG5cdFxuXHR2YXIgcGFsZXR0ZVRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiB7XG5cdFx0XHRtYWluIDogJycsXG5cdFx0XHRjb21wbGVtZW50YXJ5IDogJycsXG5cdFx0XHRkYXJrIDogJycsXG5cdFx0XHRsaWdodCA6ICcnLFxuXHRcdFx0bm9IYXNoIDoge1xuXHRcdFx0XHRtYWluIDogJycsXG5cdFx0XHRcdGNvbXBsZW1lbnRhcnkgOiAnJyxcblx0XHRcdFx0ZGFyayA6ICcnLFxuXHRcdFx0XHRsaWdodCA6ICcnXG5cdFx0XHR9LFxuXHRcdFx0bHVtaW5vY2l0eSA6IHtcblx0XHRcdFx0bWFpbiA6ICcnLFxuXHRcdFx0XHRjb21wbGVtZW50YXJ5IDogJycsXG5cdFx0XHRcdGRhcmsgOiAnJyxcblx0XHRcdFx0bGlnaHQgOiAnJ1xuXHRcdFx0fSxcblx0XHRcdHVpQ29sb3JzIDoge1xuXHRcdFx0XHRiYWNrZ3JvdW5kIDogJycsXG5cdFx0XHRcdGhleCA6ICcnLFxuXHRcdFx0XHR0ZXh0cyA6ICcnXG5cdFx0XHR9XG5cdFx0fTtcblx0fTtcblx0XG5cdHRoaXMucmFuZG9tID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG1haW5IZXggID0gcmFuZG9tSGV4KCk7XG5cdFx0dmFyIGRhcmtIZXggID0gcmFuZG9tU2hhZGVzKHRydWUpO1xuXHRcdHZhciBsaWdodEhleCA9IHJhbmRvbVNoYWRlcyhmYWxzZSk7XG5cdFxuXHRcdHZhciBwYWxldHRlID0gc2VsZi5wYWxldHRlKHtcblx0XHRcdG1haW5IZXggOiBtYWluSGV4LFxuXHRcdFx0ZGFya0hleCA6IGRhcmtIZXgsXG5cdFx0XHRsaWdodEhleCA6IGxpZ2h0SGV4XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIHBhbGV0dGU7XG5cdH07XG5cdFxuXHR0aGlzLnBhbGV0dGUgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dmFyIGRlZmF1bHRzID0ge1xuXHRcdFx0bWFpbkhleCA6ICcjRkZGRkZGJyxcblx0XHRcdGRhcmtIZXggOiAnIzQyNDI0MicsXG5cdFx0XHRsaWdodEhleCA6ICcjRkFGQUZBJ1xuXHRcdH1cbiAgICAgICAgXG5cdFx0dmFyIG9wdHMgICAgPSBleHRlbmQoZGVmYXVsdHMsIG9wdGlvbnMpO1xuXHRcdHZhciBwYWxldHRlID0gbmV3IHBhbGV0dGVUZW1wbGF0ZSgpO1xuXHRcdFxuXHRcdHBhbGV0dGUubWFpbiAgICAgICAgICAgID0gb3B0cy5tYWluSGV4O1xuXHRcdHBhbGV0dGUubm9IYXNoLm1haW4gICAgID0gY3V0SGV4KHBhbGV0dGUubWFpbikudG9VcHBlckNhc2UoKTtcblx0XHRwYWxldHRlLmx1bWlub2NpdHkubWFpbiA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5tYWluKTtcblx0XHRcblx0XHRwYWxldHRlLmNvbXBsZW1lbnRhcnkgICAgICAgICAgICA9IGZpbmRDb21wbGVtZW50YXJ5KG9wdHMubWFpbkhleCk7XG5cdFx0cGFsZXR0ZS5ub0hhc2guY29tcGxlbWVudGFyeSAgICAgPSBjdXRIZXgocGFsZXR0ZS5jb21wbGVtZW50YXJ5KS50b1VwcGVyQ2FzZSgpO1xuXHRcdHBhbGV0dGUubHVtaW5vY2l0eS5jb21wbGVtZW50YXJ5ID0gaGV4THVtaW5vY2l0eShwYWxldHRlLmNvbXBsZW1lbnRhcnkpO1xuXHRcdFxuXHRcdHBhbGV0dGUuZGFyayAgICAgICAgICAgID0gaGV4QmxlbmRPdmVybGF5KG9wdHMubWFpbkhleCwgMC4yLCBvcHRzLmRhcmtIZXgpO1xuXHRcdHBhbGV0dGUubm9IYXNoLmRhcmsgICAgID0gY3V0SGV4KHBhbGV0dGUuZGFyaykudG9VcHBlckNhc2UoKTtcblx0XHRwYWxldHRlLmx1bWlub2NpdHkuZGFyayA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5kYXJrKTtcblx0XHRcblx0XHRwYWxldHRlLmxpZ2h0ICAgICAgICAgICAgPSBoZXhCbGVuZE92ZXJsYXkob3B0cy5tYWluSGV4LCAwLjIsIG9wdHMubGlnaHRIZXgpO1xuXHRcdHBhbGV0dGUubm9IYXNoLmxpZ2h0ICAgICA9IGN1dEhleChwYWxldHRlLmxpZ2h0KS50b1VwcGVyQ2FzZSgpO1xuXHRcdHBhbGV0dGUubHVtaW5vY2l0eS5saWdodCA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5saWdodCk7XG5cblx0XHRwYWxldHRlLnVpQ29sb3JzID0gZXh0ZW5kKHBhbGV0dGUudWlDb2xvcnMsIGdlbmVyYXRlVUlDb2xvcnMocGFsZXR0ZS5tYWluKSk7XG5cdFx0XG5cdFx0cmV0dXJuIHBhbGV0dGU7XG5cdH07XG5cdFxuXHR0aGlzLmdlbmVyYXRlUGFsZXR0ZUZyb21VUkwgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dmFyIHBhbGV0dGUgPSBleHRlbmQobmV3IHBhbGV0dGVUZW1wbGF0ZSgpLCBvcHRpb25zKTtcblx0XHRcblx0XHRwYWxldHRlLmx1bWlub2NpdHkubWFpbiAgICAgICAgICA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5tYWluKTtcblx0XHRwYWxldHRlLmx1bWlub2NpdHkuY29tcGxlbWVudGFyeSA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5jb21wbGVtZW50YXJ5KTtcblx0XHRwYWxldHRlLmx1bWlub2NpdHkuZGFyayAgICAgICAgICA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5kYXJrKTtcblx0XHRwYWxldHRlLmx1bWlub2NpdHkubGlnaHQgICAgICAgICA9IGhleEx1bWlub2NpdHkocGFsZXR0ZS5saWdodCk7XG5cblx0XHRwYWxldHRlLnVpQ29sb3JzID0gZXh0ZW5kKHBhbGV0dGUudWlDb2xvcnMsIGdlbmVyYXRlVUlDb2xvcnMocGFsZXR0ZS5tYWluKSk7XG5cdFx0XG5cdFx0cmV0dXJuIHBhbGV0dGU7XG5cdH07XG5cdFxuXHR0aGlzLmhleFRvUkdCQSA9IGZ1bmN0aW9uKGhleCwgYWxwaGEpIHtcblx0XHRyZXR1cm4gaGV4VG9SR0JBKGhleCwgYWxwaGEpO1xuXHR9O1xuXHRcblx0dGhpcy5yZ2JhVG9IZXggPSBmdW5jdGlvbihyZ2JhLCBiYXNlUkdCKSB7XG5cdFx0cmV0dXJuIHJnYmFUb0hleChyZ2JhLCBiYXNlUkdCKTtcblx0fTtcblx0XG5cdHRoaXMuaGV4T3BhY2l0eSA9IGZ1bmN0aW9uKGhleCwgYWxwaGEsIGJhc2VIZXgpIHtcblx0XHRyZXR1cm4gaGV4T3BhY2l0eShoZXgsIGFscGhhLCBiYXNlSGV4KTtcblx0fTtcblx0XG5cdHRoaXMuaGV4QmxlbmRPdmVybGF5ID0gZnVuY3Rpb24oaGV4LCBhbHBoYSwgYmFzZUhleCkge1xuXHRcdHJldHVybiBoZXhCbGVuZE92ZXJsYXkoaGV4LCBhbHBoYSwgYmFzZUhleCk7XG5cdH07XG5cdFxuXHR0aGlzLmhleEx1bWlub2NpdHkgPSBmdW5jdGlvbihoZXgpIHtcblx0XHRyZXR1cm4gaGV4THVtaW5vY2l0eShoZXgpO1xuXHR9O1xuXHRcblx0LyoqXG5cdCAqIEZpbmQgY29tcGxlbWVudGFyeSBjb2xvciBcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtzdHJ9IGhleCBUaGUgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtzdHJ9ICAgVGhlIGNvbXBsZW1lbnRhcnkgY29sb3IgaGV4IHN0cmluZ1xuXHQgKi9cblx0ZnVuY3Rpb24gZmluZENvbXBsZW1lbnRhcnkoaGV4KSB7XG5cdFx0dmFyIGhleCAgICAgICAgICAgPSBoZXhTdHJpbmdUb2hleChoZXgpO1xuXHRcdHZhciBjb21wbGVtZW50YXJ5ID0gKDAwMDAwMCArICgoMHhmZmZmZmYgLSBoZXgpLnRvU3RyaW5nKDE2KSkpLnNsaWNlKC02KTtcbiAgICAgICAgXG5cdFx0d2hpbGUgKGNvbXBsZW1lbnRhcnkubGVuZ3RoIDwgNikge1xuXHRcdFx0Y29tcGxlbWVudGFyeSA9ICcwJyArIGNvbXBsZW1lbnRhcnk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiAnIycgKyBjb21wbGVtZW50YXJ5O1xuXHR9XG5cdFxuXHQvKipcblx0ICogUmVjcmVhdGVzIGJsZW5kIG1vZGUgbXVsdGlwbHkgYW5kIHJldHVybnMgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiBcblx0ICogQHBhcmFtICAge29ian0gICBiYXNlUkdCICAgT2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIFJHQiB2YWx1ZXMgb2YgdGhlIGJhc2UgY29sb3Jcblx0ICogQHBhcmFtICAge29ian0gICBjb2xvclJHQkEgT2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIFJHQkEgdmFsdWVzIG9mIHRoZSBibGVuZGVkIGNvbG9yXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7c3RyfSBUaGUgaGV4IGNvbG9yIHN0cmluZyBvZiB0aGUgcmVzdWx0aW5nIGNvbG9yXG5cdCAqL1xuXHRmdW5jdGlvbiBibGVuZE11bHRpcGx5KGJhc2VSR0IsIGNvbG9yUkdCQSkge1xuXHRcdHZhciBibGVuZCA9IHt9O1xuXHQgIFxuXHRcdGJsZW5kLnIgPSBNYXRoLnJvdW5kKCgyICogYmFzZVJHQi5yICogY29sb3JSR0JBLnIpIC8gMjU1KTtcblx0XHRibGVuZC5nID0gTWF0aC5yb3VuZCgoMiAqIGJhc2VSR0IuZyAqIGNvbG9yUkdCQS5nKSAvIDI1NSk7XG5cdFx0YmxlbmQuYiA9IE1hdGgucm91bmQoKDIgKiBiYXNlUkdCLmIgKiBjb2xvclJHQkEuYikgLyAyNTUpO1xuXHRcdGJsZW5kLmEgPSBjb2xvclJHQkEuYTtcblx0ICBcblx0XHRyZXR1cm4gcmdiYVRvSGV4KGJsZW5kLCBiYXNlUkdCKTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIFJlY3JlYXRlcyBibGVuZCBtb2RlIHNjcmVlbiBhbmQgcmV0dXJucyBoZXggY29sb3Igc3RyaW5nXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7b2JqfSAgIGJhc2VSR0IgICBPYmplY3QgdGhhdCBjb250YWlucyB0aGUgUkdCIHZhbHVlcyBvZiB0aGUgYmFzZSBjb2xvclxuXHQgKiBAcGFyYW0gICB7b2JqfSAgIGNvbG9yUkdCQSBPYmplY3QgdGhhdCBjb250YWlucyB0aGUgUkdCQSB2YWx1ZXMgb2YgdGhlIGJsZW5kZWQgY29sb3Jcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtzdHJ9IFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSByZXN1bHRpbmcgY29sb3Jcblx0ICovXG5cdGZ1bmN0aW9uIGJsZW5kU2NyZWVuKGJhc2VSR0IsIGNvbG9yUkdCQSkge1xuXHRcdHZhciBibGVuZCA9IHt9O1xuXHQgIFxuXHRcdGJsZW5kLnIgPSBNYXRoLnJvdW5kKCgxIC0gKCgxIC0gKGJhc2VSR0Iuci8yNTUpKSAqICgxIC0gKDIgKiBjb2xvclJHQkEuci8yNTUgLSAxKSkpKSAqIDI1NSk7XG5cdFx0YmxlbmQuZyA9IE1hdGgucm91bmQoKDEgLSAoKDEgLSAoYmFzZVJHQi5nLzI1NSkpICogKDEgLSAoMiAqIGNvbG9yUkdCQS5nLzI1NSAtIDEpKSkpICogMjU1KTtcblx0XHRibGVuZC5iID0gTWF0aC5yb3VuZCgoMSAtICgoMSAtIChiYXNlUkdCLmIvMjU1KSkgKiAoMSAtICgyICogY29sb3JSR0JBLmIvMjU1IC0gMSkpKSkgKiAyNTUpO1xuXHRcdGJsZW5kLmEgPSBjb2xvclJHQkEuYTtcblx0ICBcblx0XHRyZXR1cm4gcmdiYVRvSGV4KGJsZW5kLCBiYXNlUkdCKTtcblx0fVxuXHRcblx0LyoqXG4gICAgICogUmVjcmVhdGVzIGJsZW5kIG1vZGUgb3ZlcmxheSBhbmQgcmV0dXJucyBoZXggY29sb3Igc3RyaW5nXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7b2JqfSBiYXNlUkdCICAgT2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIFJHQiB2YWx1ZXMgb2YgdGhlIGJhc2UgY29sb3Jcblx0ICogQHBhcmFtICAge29ian0gY29sb3JSR0JBIE9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSBSR0JBIHZhbHVlcyBvZiB0aGUgYmxlbmRlZCBjb2xvclxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7c3RyfSBUaGUgaGV4IGNvbG9yIHN0cmluZyBvZiB0aGUgcmVzdWx0aW5nIGNvbG9yXG5cdCAqL1xuXHRmdW5jdGlvbiBibGVuZE92ZXJsYXkoYmFzZVJHQiwgY29sb3JSR0JBKSB7XG5cdFx0dmFyIGx1bWVuID0gcmdiTHVtaW5vY2l0eShiYXNlUkdCKTtcblx0XHR2YXIgYmxlbmQgPSAnJztcbiAgICAgICAgXG4gICAgICAgIC8vIEJsZW5kIG1vZGUgb3ZlcmxheSBpcyBtdWx0aXBseSBmb3IgZGFyayBjb2xvcnMgYW5kIHNjcmVlbiBmb3IgbGlnaHQgb25lc1xuXHRcdGlmIChsdW1lbiA8PSAwLjUpIHtcblx0XHRcdGJsZW5kID0gYmxlbmRNdWx0aXBseShiYXNlUkdCLCBjb2xvclJHQkEpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRibGVuZCA9IGJsZW5kU2NyZWVuKGJhc2VSR0IsIGNvbG9yUkdCQSk7XG5cdFx0fVxuXHQgIFxuXHRcdHJldHVybiBibGVuZDtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENhbGN1bGF0ZXMgdGhlIGx1bWlub2NpdHkgb2YgYSBjb2xvclxuXHQgKiBcblx0ICogQHBhcmFtICAge29ian0gICByZ2IgT2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIFJHQiB2YWx1ZXMgb2YgdGhlIGNvbG9yXG5cdCAqICAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7bnVtfSBUaGUgbHVtaW5vY2l0eSBvZiBhIGNvbG9yICgwLTEpXG5cdCAqL1xuXHRmdW5jdGlvbiByZ2JMdW1pbm9jaXR5KHJnYikge1xuXHRcdHJldHVybiAoKHJnYi5yICsgcmdiLmcgKyByZ2IuYikvMykvMjU1O1xuXHR9XG5cdFxuXHQvKipcblx0ICogQ29udmVydHMgYW4gUkdCQSBjb2xvciB0byBoZXggc3RyaW5nIGdldHRpbmcgaW50byBjb25zaWRlcmF0aW9uIHRoZSBiYXNlIGNvbG9yXG5cdCAqIFJlcHJvZHVjZXMgaW4gaGV4IHRoZSBzYW1lIHZpc3VhbCByZXN1bHQgYXMgYW4gUkdCQSBjb2xvciBhYm92ZSBhbm90aGVyIGJhc2UgY29sb3Jcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtvYmp9ICAgcmdiYSAgICBPYmplY3QgdGhhdCBjb250YWlucyB0aGUgUkdCQSB2YWx1ZXMgb2YgdGhlIGNvbG9yXG5cdCAqIEBwYXJhbSAgIHtvYmp9ICAgYmFzZVJHQiBPYmplY3QgdGhhdCBjb250YWlucyB0aGUgUkdCIHZhbHVlcyBvZiB0aGUgYmFzZSBjb2xvclxuXHQgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtzdHJ9IFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSByZXN1bHRpbmcgY29sb3Jcblx0ICovXG5cdGZ1bmN0aW9uIHJnYmFUb0hleChyZ2JhLCBiYXNlUkdCKSB7XG5cdFx0dmFyIHJnYiA9IHt9O1xuXHRcdFxuXHRcdHJnYi5yID0gKDEgLSByZ2JhLmEpICogYmFzZVJHQi5yICsgcmdiYS5hICogcmdiYS5yO1xuXHRcdHJnYi5nID0gKDEgLSByZ2JhLmEpICogYmFzZVJHQi5nICsgcmdiYS5hICogcmdiYS5nO1xuXHRcdHJnYi5iID0gKDEgLSByZ2JhLmEpICogYmFzZVJHQi5iICsgcmdiYS5hICogcmdiYS5iO1xuXHRcdFxuXHRcdHJldHVybiByZ2JUb0hleChyZ2IuciwgcmdiLmcsIHJnYi5iKTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENvbnZlcnRzIGhleCBjb2xvciB0byBSR0JBXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7c3RyfSBoZXggICBUaGUgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiBAcGFyYW0gICB7bnVtfSBhbHBoYSBUaGUgZGVzaXJlZCBBbHBoYSBjaGFubmVsIHZhbHVlIChtdXN0IGJlIDAtMSlcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge29ian0gQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIFJHQkEgdmFsdWVzIG9mIHRoZSBjb2xvclxuXHQgKi9cblx0ZnVuY3Rpb24gaGV4VG9SR0JBKGhleCwgYWxwaGEpIHtcblx0XHR2YXIgcmdiYSA9IHtcblx0XHRcdHI6IGhleFRvUihoZXgpLFxuXHRcdFx0ZzogaGV4VG9HKGhleCksXG5cdFx0XHRiOiBoZXhUb0IoaGV4KSxcblx0XHRcdGE6IGFscGhhXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gcmdiYTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIFJldHJpZXZlcyB0aGUgUiBjaGFubmVsIHZhbHVlIGZyb20gYSBoZXggY29sb3Igc3RyaW5nXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7c3RyfSBoZXggVGhlIGhleCBjb2xvciBzdHJpbmdcblx0ICogICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7aW50fSBUaGUgUiBjaGFubmVsIHZhbHVlIG9mIHRoZSBjb2xvclxuXHQgKi9cblx0ZnVuY3Rpb24gaGV4VG9SKGhleCkge1xuXHRcdHJldHVybiBwYXJzZUludCgoY3V0SGV4KGhleCkpLnN1YnN0cmluZygwLDIpLDE2KTtcblx0fVxuXHRcbiAgICAvKipcblx0ICogUmV0cmlldmVzIHRoZSBHIGNoYW5uZWwgdmFsdWUgZnJvbSBhIGhleCBjb2xvciBzdHJpbmdcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtzdHJ9IGhleCBUaGUgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtpbnR9IFRoZSBHIGNoYW5uZWwgdmFsdWUgb2YgdGhlIGNvbG9yXG5cdCAqL1xuXHRmdW5jdGlvbiBoZXhUb0coaGV4KSB7XG5cdFx0cmV0dXJuIHBhcnNlSW50KChjdXRIZXgoaGV4KSkuc3Vic3RyaW5nKDIsNCksMTYpO1xuXHR9XG5cdFxuICAgIC8qKlxuXHQgKiBSZXRyaWV2ZXMgdGhlIEIgY2hhbm5lbCB2YWx1ZSBmcm9tIGEgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiBcblx0ICogQHBhcmFtICAge3N0cn0gaGV4IFRoZSBoZXggY29sb3Igc3RyaW5nXG5cdCAqICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge2ludH0gVGhlIEIgY2hhbm5lbCB2YWx1ZSBvZiB0aGUgY29sb3Jcblx0ICovXG5cdGZ1bmN0aW9uIGhleFRvQihoZXgpIHtcblx0XHRyZXR1cm4gcGFyc2VJbnQoKGN1dEhleChoZXgpKS5zdWJzdHJpbmcoNCw2KSwxNik7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBSZXR1cm5zIGEgaGV4IGNvbG9yIHN0cmluZyB3aXRob3V0IHRoZSAnIycgY2hhcmFjdGVyIChpZiBpdCBleGlzdHMpXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7c3RyfSAgIGhleCBUaGUgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiAgICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge3N0cn0gVGhlIGhleCBjb2xvciBzdHJpbmcgd2l0aG91dCB0aGUgJyMnIGNoYXJhY3RlclxuXHQgKi9cblx0ZnVuY3Rpb24gY3V0SGV4KGhleCkge1xuXHRcdHJldHVybiAoaGV4LmNoYXJBdCgwKT09XCIjXCIpID8gaGV4LnN1YnN0cmluZygxLDcpOmhleDtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENvbnZlcnRzIGhleCBjb2xvciBzdHJpbmcgdG8gaGV4IG51bWJlclxuXHQgKiBcblx0ICogQHBhcmFtICAge3N0cn0gICBoZXhTdHJpbmcgVGhlIGhleCBjb2xvciBzdHJpbmdcblx0ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtpbnR9IFRoZSBoZXggY29sb3Jcblx0ICovXG5cdGZ1bmN0aW9uIGhleFN0cmluZ1RvaGV4KGhleFN0cmluZykge1xuXHRcdHJldHVybiBwYXJzZUludChoZXhTdHJpbmcucmVwbGFjZSgvXiMvLCAnJyksIDE2KTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENvbnZlcnRzIFJHQiBjaGFubmVscyB0byBoZXggY29sb3Igc3RyaW5nXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7aW50fSBSIFRoZSBSIGNoYW5uZWxcblx0ICogQHBhcmFtICAge2ludH0gRyBUaGUgRyBjaGFubmVsXG5cdCAqIEBwYXJhbSAgIHtpbnR9IEIgVGhlIEIgY2hhbm5lbFxuXHQgKiAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7c3RyfSAgIFRoZSBoZXggY29sb3Igc3RyaW5nXG5cdCAqL1xuXHRmdW5jdGlvbiByZ2JUb0hleChSLEcsQikge1xuXHRcdHJldHVybiAnIycgKyB0b0hleChSKSArIHRvSGV4KEcpICsgdG9IZXgoQik7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIG51bWJlciB0byBoZXhcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtpbnR9IG4gVGhlIG51bWJlclxuXHQgKiAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7c3RyfSAgIFRoZSBoZXggY29kZVxuXHQgKi9cblx0ZnVuY3Rpb24gdG9IZXgobikge1xuXHRcdG4gPSBwYXJzZUludChuLDEwKTtcblx0XHRpZiAoaXNOYU4obikpIHJldHVybiBcIjAwXCI7XG5cdFx0biA9IE1hdGgubWF4KDAsTWF0aC5taW4obiwyNTUpKTtcblx0XHRyZXR1cm4gXCIwMTIzNDU2Nzg5QUJDREVGXCIuY2hhckF0KChuLW4lMTYpLzE2KVxuXHRcdFx0KyBcIjAxMjM0NTY3ODlBQkNERUZcIi5jaGFyQXQobiUxNik7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHJhbmRvbUhleCgpIHtcblx0XHR2YXIgcmFuZG9tID0gJyc7XG4gICAgICAgIFxuXHRcdHdoaWxlIChyYW5kb20ubGVuZ3RoIDwgNikge1xuXHRcdFx0cmFuZG9tICs9IChNYXRoLnJhbmRvbSgpKS50b1N0cmluZygxNikuc3Vic3RyKC02KS5zdWJzdHIoLTEpO1xuXHRcdH1cbiAgICAgICAgXG5cdFx0cmV0dXJuICcjJyArIHJhbmRvbTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhIHJhbmRvbSBzaGFkZSAoZGFyayBvciBsaWdodCkgb2YgYSBwcmVkZWZpbmVkIGNvbG9yXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7Ym9vfSBkYXJrIEJvb2xlYW4gdmFsdWUgZm9yIHNldHRpbmcgZGFyayBvciBsaWdodCBjb2xvclxuXHQgKiAgICAgICAgICAgICAgICAgICAgIFxuXHQgKiBAcmV0dXJucyB7c3RyfSAgIFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSByZXN1bHRpbmcgc2hhZGVcblx0ICovXG5cdGZ1bmN0aW9uIHJhbmRvbVNoYWRlcyhkYXJrKSB7XG5cdFx0dmFyIHBlcmNlbnQgPSBNYXRoLnJhbmRvbSgpO1xuXHRcdHZhciBjb2xvciAgID0gJyNFRUVFRUUnXG4gICAgICAgIFxuXHRcdGlmIChkYXJrKSB7XG5cdFx0XHRjb2xvciAgID0gJyM3Nzc3NzcnO1xuXHRcdFx0cGVyY2VudCA9IC0gcGVyY2VudDtcblx0XHR9XG5cdFx0XG5cdFx0dmFyIGYgPSBwYXJzZUludChjb2xvci5zbGljZSgxKSwxNiksdD1wZXJjZW50PDA/MDoyNTUscD1wZXJjZW50PDA/cGVyY2VudCotMTpwZXJjZW50LFI9Zj4+MTYsRz1mPj44JjB4MDBGRixCPWYmMHgwMDAwRkY7XG4gICAgICAgIFxuXHRcdHJldHVybiBcIiNcIisoMHgxMDAwMDAwKyhNYXRoLnJvdW5kKCh0LVIpKnApK1IpKjB4MTAwMDArKE1hdGgucm91bmQoKHQtRykqcCkrRykqMHgxMDArKE1hdGgucm91bmQoKHQtQikqcCkrQikpLnRvU3RyaW5nKDE2KS5zbGljZSgxKTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhIGhleCBjb2xvciB0aGF0IGVtdWxhdGVzIHRoZSB2aXN1YWwgcmVzdWx0IG9mIGEgY29sb3IgKHdpdGggb3BhY2l0eSkgb3ZlciBhbm90aGVyXG5cdCAqIFxuXHQgKiBAcGFyYW0gICB7c3RyfSBoZXggICAgIFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSBjb2xvclxuXHQgKiBAcGFyYW0gICB7aW50fSBhbHBoYSAgIFRoZSBBbHBoYSBjaGFubmVsIHZhbHVlIHdlIGRlc2lyZVxuXHQgKiBAcGFyYW0gICB7c3RyfSBiYXNlSGV4IFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSBiYXNlIGNvbG9yXG5cdCAqICAgICAgICAgICAgICAgICAgICAgICAgXG5cdCAqIEByZXR1cm5zIHtzdHJ9IFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSByZXN1bHRpbmcgY29sb3Jcblx0ICovXG5cdGZ1bmN0aW9uIGhleE9wYWNpdHkoaGV4LCBhbHBoYSwgYmFzZUhleCkge1xuXHRcdHZhciByZ2JhICAgICA9IGhleFRvUkdCQShoZXgsIGFscGhhKTtcblx0XHR2YXIgYmFzZVJHQkEgPSBoZXhUb1JHQkEoYmFzZUhleCwgMSk7XG5cdFx0XG5cdFx0cmV0dXJuIHJnYmFUb0hleChyZ2JhLCBiYXNlUkdCQSk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYSBoZXggY29sb3IgdGhhdCBlbXVsYXRlcyB0aGUgdmlzdWFsIHJlc3VsdCBvZiBvdmVybGF5IGJsZW5kIG1vZGVcblx0ICogXG5cdCAqIEBwYXJhbSAgIHtzdHJ9IGhleCAgICAgVGhlIGhleCBjb2xvciBzdHJpbmcgb2YgdGhlIGNvbG9yXG5cdCAqIEBwYXJhbSAgIHtpbnR9IGFscGhhICAgVGhlIEFscGhhIGNoYW5uZWwgdmFsdWUgd2UgZGVzaXJlXG5cdCAqIEBwYXJhbSAgIHtzdHJ9IGJhc2VIZXggVGhlIGhleCBjb2xvciBzdHJpbmcgb2YgdGhlIGJhc2UgY29sb3Jcblx0ICogICAgICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge3N0cn0gVGhlIGhleCBjb2xvciBzdHJpbmcgb2YgdGhlIHJlc3VsdGluZyBjb2xvclxuXHQgKi9cblx0ZnVuY3Rpb24gaGV4QmxlbmRPdmVybGF5KGhleCwgYWxwaGEsIGJhc2VIZXgpIHtcblx0XHR2YXIgcmdiYSAgICAgPSBoZXhUb1JHQkEoaGV4LCBhbHBoYSk7XG5cdFx0dmFyIGJhc2VSR0JBID0gaGV4VG9SR0JBKGJhc2VIZXgsIDEpO1xuXHRcdFxuXHRcdHJldHVybiBibGVuZE92ZXJsYXkoYmFzZVJHQkEsIHJnYmEpO1xuXHR9XG5cdFxuICAgIC8qKlxuXHQgKiBDYWxjdWxhdGVzIHRoZSBsdW1pbm9jaXR5IG9mIGEgaGV4IGNvbG9yIHN0cmluZ1xuXHQgKiBcblx0ICogQHBhcmFtICAge3N0cn0gaGV4ICAgICBUaGUgaGV4IGNvbG9yIHN0cmluZyBcblx0ICogICAgICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge2ludH0gVGhlIGx1bWlub2NpdHkgb2YgdGhlIGNvbG9yXG5cdCAqL1xuXHRmdW5jdGlvbiBoZXhMdW1pbm9jaXR5KGhleCkge1xuXHRcdHZhciByZ2IgPSBoZXhUb1JHQkEoaGV4LCAxKTtcblx0XHRcblx0XHRyZXR1cm4gcmdiTHVtaW5vY2l0eShyZ2IpO1xuXHR9XG5cdFxuXHQvKipcblx0ICogR2VuZXJhdGVzIHRoZSBjb2xvcnMgZm9yIHRoZSBVSVxuXHQgKiBcblx0ICogQHBhcmFtICAge3N0cn0gaGV4IFRoZSBoZXggY29sb3Igc3RyaW5nIG9mIHRoZSBiYXNlIGNvbG9yXG5cdCAqICAgICAgICAgICAgICAgICAgICBcblx0ICogQHJldHVybnMge29ian0gT2JqZWN0IGNvbnRhaW5pbmcgdGhlIGRpZmZlcmVudCBVSSBjb2xvcnNcblx0ICovXG5cdGZ1bmN0aW9uIGdlbmVyYXRlVUlDb2xvcnMoaGV4KSB7XG5cdFx0dmFyIFVJQ29sb3JzICAgICAgICA9IHt9O1xuXHRcdFVJQ29sb3JzLmJhY2tncm91bmQgPSBoZXhPcGFjaXR5KGhleCwgMC4xLCAnI0ZGRkZGRicpO1xuXHRcdFVJQ29sb3JzLmhleCAgICAgICAgPSBoZXhPcGFjaXR5KGhleCwgMC42LCBVSUNvbG9ycy5iYWNrZ3JvdW5kKTtcblx0XHRcblx0XHRpZiAoaGV4THVtaW5vY2l0eShVSUNvbG9ycy5iYWNrZ3JvdW5kKSA+IDAuODUgJiYgaGV4THVtaW5vY2l0eShVSUNvbG9ycy5oZXgpID4gMC44NSkge1xuXHRcdFx0VUlDb2xvcnMuaGV4ID0gaGV4T3BhY2l0eShVSUNvbG9ycy5oZXgsIDAuOSwgJyM0MjQyNDInKTtcblx0XHR9XG5cdFx0XG5cdFx0VUlDb2xvcnMudGV4dHMgPSBoZXhCbGVuZE92ZXJsYXkoaGV4LCAwLjIsICcjNDI0MjQyJyk7XG5cdFx0XG5cdFx0cmV0dXJuIFVJQ29sb3JzO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBleHRlbmQoYSwgYikge1xuXHRcdGZvciAodmFyIGtleSBpbiBiKSB7XG5cdFx0XHRpZiAoYi5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRcdGFba2V5XSA9IGJba2V5XTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIGE7XG5cdH1cblx0XG59KTtcbiJdfQ==
